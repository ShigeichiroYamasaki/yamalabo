# SBT (SoulBound Token) 譲渡不可能なNFT

2024/12/03
Shigeichiro Yamasaki

## ERC-5192 の仕様

[ERC-5192: Minimal Soulbound NFTs](https://eips.ethereum.org/EIPS/eip-5192)

### ERC-5192 の概要

* ERC-721 NFTを拡張し，単一のアカウントにバインドされたNFTを定義する．
* この ERC はERC-721トークンをソウルバウンドにするための最小限の interface の定義
* EIP-165 の interface 検出機能を使用する

## Solidity の interface とは何か？

トークンのようなコントラクトは流通性を持たないと意味がありません．
そのために，ERC-20 や ERC-721 などのような標準的なコントラクトを継承してアプリケーション用のトークンを作ることで標準的なワレットなどであ使えるようにして流通性を担保します．

しかし，実際のトークンはアプリケーションによって様々な拡張機能を持ちます．そのような拡張機能を流通性を維持しながら有効利用する方法が必要になります．その方法が interface です．

### 既存の（古い）プログラムが新しいプログラムを利用する方法

新しいプログラムを作成するときに既存のモジュールを部品として利用するのは簡単です．
しかし，既存のプログラムを変更しないまま，それから新しいプログラムを呼び出して利用するのは簡単ではありません．

しかし実現可能です．例えば photoshop の画像加工プラグインモジュールはこれを実現しています．
新しい画像加工モジュールを photoshop にインストールすると，photoshopのメニューにその機能が追加されて使えるようになります．

これができるのは，photoshop にあらかじめ追加されたプラグインモジュールの存在を知り，その機能を呼び出すためのインターフェースが定義されているからです．

### Solidity の interface は「新しい機能」の存在を知り，その機能を呼び出す方法



### トークンへの interface の定義の重要性

トークンはお金と同様にアプリケーションやサービスの境界を超えて広域的に流通します．
新しいトークンのために多数のアプリケーションやサービスが対応してくれることを望むことは現実的ではありません．

interface は，



### ERC-165 (Standard Interface Detection) とは

対象となるスマートコントラクトがどのようなインターフェースを持っているかを公開・検知するための規格

* トークンが流通性を持つためには，相互運用性のためにそのトークンへのインターフェースが公開されている必要がある
* ERC-165 に準拠したコントラクトは以下の「インターフェースの存在を確認する関数」を定義している

```js
supportsInterface()
```

* ERC-5192 は ERC-721 NFT に対して ERC-165 に準拠した最小限のインターフェースを定義可能にしたものである

### NFTの移転のロック方法

`locked(uint256 tokenId)` という名前の関数を使ってトークンのロック状態を照会できます。
トークンがロックされている場合、すべてのEIP721関数はトークンの転送を拒否する必要があります。





### ERC5192 コントラクトのインターフェース

```js
// SPDX-License-Identifier: CC0-1.0
pragma solidity ^0.8.0;

interface IERC5192 {
  /// @notice Emitted when the locking status is changed to locked.
  /// @dev If a token is minted and the status is locked, this event should be emitted.
  /// @param tokenId The identifier for a token.
  event Locked(uint256 tokenId);

  /// @notice Emitted when the locking status is changed to unlocked.
  /// @dev If a token is minted and the status is unlocked, this event should be emitted.
  /// @param tokenId The identifier for a token.
  event Unlocked(uint256 tokenId);

  /// @notice Returns the locking status of an Soulbound Token
  /// @dev SBTs assigned to zero address are considered invalid, and queries
  /// about them do throw.
  /// @param tokenId The identifier for an SBT.
  function locked(uint256 tokenId) external view returns (bool);
}
```

