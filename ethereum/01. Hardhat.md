# 01. Hardhat ã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«

Ethereum ã®é–‹ç™ºç’°å¢ƒ

2025/02/07
Shigeichiro Yamasaki

* [ç’°å¢ƒã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—](#setup)
* [Hardhat ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®æ–°è¦ä½œæˆ](#project)
* [ã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®ä½œæˆã¨ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«](#compile)
* [ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®ãƒ†ã‚¹ãƒˆ](#test)
* [Hardhar Networkã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤](#hhNetwork)


##  <a id="setup">ç’°å¢ƒã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—</a>

* hardhat node ã¯ãƒ­ãƒ¼ã‚«ãƒ«ãƒã‚·ãƒ³ã§å®Ÿè¡Œã™ã‚‹ã“ã¨ã‚’å‰æã«ã—ã¾ã™
* Node.js ã¨ JavaScriptã®çŸ¥è­˜ãŒå‰æã«ãªã‚Šã¾ã™

### ubuntu

```bash
sudo apt update
sudo apt upgrade -y
sudo apt install -y curl git tree
curl https://raw.githubusercontent.com/creationix/nvm/master/install.sh | bash
source ~/.profile

nvm install --lts
npm install -g yarn

node -v
=>
v22.13.1
```
* VS code ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
sudo snap install --classic code
```

### MacOSX

```bash
brew update
brew upgrade
brew install curl git tree
source $(brew --prefix nvm)/nvm.sh
echo 'source $(brew --prefix nvm)/nvm.sh' >> ~/.zprofile
source ~/.zprofile

nvm install 22.13.1
npm install -g yarn

node -v
=>
v22.13.1
```

* VS code ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

[https://code.visualstudio.com/download](https://code.visualstudio.com/download) ã‹ã‚‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ©ãƒ¼ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰

## <a id="project">Hardhat ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®æ–°è¦ä½œæˆ</a>

### ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ•ã‚©ãƒ«ãƒ€ã®ä½œæˆ

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ•ã‚©ãƒ«ãƒ€ã‚’æ±ºã‚ã¾ã™ï¼

â˜… ã“ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ã€Œãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã€ã¨ã„ã„ã¾ã™ï¼

```bash
cd ~
mkdir hardhat
cd hardhat/
mkdir tutorial
cd tutorial
```

* ã“ã“ã§ã¯ï¼Œãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã‚’ hardhat/tutolial ã¨ã„ã†åå‰ã®ãƒ•ã‚©ãƒ«ãƒ€ã«ã—ã¾ã™ãŒï¼Œé©å®œè‡ªåˆ†ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåã«ä¿®æ­£ã—ã¦ãã ã•ã„

### VS codeã‚’åˆ©ç”¨ã™ã‚‹å ´åˆ

æ‹¡å¼µæ©Ÿèƒ½ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

* Japanese Language Pack for Visual Studio Code
* Hardhat Developer Pack

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’VS codenpm  ã‹ã‚‰æŒ‡å®š

### JavaScript ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ

init ã‚³ãƒãƒ³ãƒ‰ã§ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ•ã‚©ãƒ«ãƒ€ç¾¤ã‚’è‡ªå‹•ç”Ÿæˆã—ã¾ã™ï¼
ã¾ãŸï¼Œã“ã®ãƒ‘ã‚¹ãŒãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®èµ·ç‚¹ã¨ãªã‚‹ã€Œãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã€ã«ãªã‚Šã¾ã™ï¼
è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã¯ï¼Œpackage.json ã¨ã„ã†ãƒ•ã‚¡ã‚¤ãƒ«ã§ã™ï¼

```bash
yarn init -y
```

### Hardhat ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
yarn add --dev hardhat
```

### Hardhat ã®åˆæœŸåŒ–

åˆæœŸåŒ–ã‚³ãƒãƒ³ãƒ‰ `npx hardhat init` å®Ÿè¡Œå¾Œã«

â–¶ Create a JavaScript project ã‚’é¸æŠï¼ˆã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã®çŸ¢å°ã‚­ãƒ¼ã‚’ä½¿ã£ã¦ï¼‰

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ï¼Œç©ºã® hardhat.config.js ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™ï¼

```bash
npx hardhat init
```

```bash
=>
888    888                      888 888               888
888    888                      888 888               888
888    888                      888 888               888
8888888888  8888b.  888d888 .d88888 88888b.   8888b.  888888
888    888     "88b 888P"  d88" 888 888 "88b     "88b 888
888    888 .d888888 888    888  888 888  888 .d888888 888
888    888 888  888 888    Y88b 888 888  888 888  888 Y88b.
888    888 "Y888888 888     "Y88888 888  888 "Y888888  "Y888

Welcome to Hardhat v2.22.5

? What do you want to do? â€¦ 
â–¸ Create a JavaScript project
  Create a TypeScript project
  Create a TypeScript project (with Viem)
  Create an empty hardhat.config.js
  Quit


```

### ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ

hardhat ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¯ä»¥ä¸‹ã®ã‚ˆã†ãªæ§‹æˆã«ãªã£ã¦ã„ã‚‹

```
tree -L 1

=>
.
â”œâ”€â”€ README.md
â”œâ”€â”€ contracts
â”œâ”€â”€ hardhat.config.js
â”œâ”€â”€ ignition
â”œâ”€â”€ node_modules
â”œâ”€â”€ package-lock.json
â”œâ”€â”€ package.json
â””â”€â”€ test

5 directories, 4 files
```

### ä½™è¨ˆãªãƒ•ã‚¡ã‚¤ãƒ«ã®å‰Šé™¤

hardhat ã¯ Lock ã¨ã„ã†åå‰ã®ã‚µãƒ³ãƒ—ãƒ«ã®ã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã¨ãƒ†ã‚¹ãƒˆãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ç”Ÿæˆã—ã¦ãã‚Œã¾ã™ï¼

ç‰¹ã«å®³ã¯ã‚ã‚Šã¾ã›ã‚“ãŒï¼Œã“ã“ã§ã¯ä½™è¨ˆãªã®ã§å‰Šé™¤ã—ã¦ã—ã¾ã„ã¾ã™

```bash
rm contracts/Lock.sol
rm test/Lock.js
rm ignition/modules/Lock.js
```

### hardhat ã®Task 

ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ãªã© Hardhat ã®ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã‹ã‚‰å®Ÿè¡Œã™ã‚‹å‡¦ç†ã®ã“ã¨

å®Ÿè¡Œå½¢å¼  `npx hardhat <ã‚¿ã‚¹ã‚¯>` 

* clean   :          ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚„ artifacts ã®å…¨ãƒ‡ãƒ¼ã‚¿ã®æ¶ˆå»
* compile :          ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã¨artifactsã®æ§‹ç¯‰
* console :          hardhat console ã®èµ·å‹•
* coverage:         ãƒ†ã‚¹ãƒˆã®ãŸã‚ã®ã‚³ãƒ¼ãƒ‰ã®é©ç”¨ç¯„å›²ã®ãƒ¬ãƒãƒ¼ãƒˆè¡¨ç¤º
* flatten :          	ä¾å­˜é–¢ä¿‚ã®ã‚ã‚‹ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‚³ãƒ¼ãƒ‰ã‚’ã™ã¹ã¦ãƒ•ãƒ©ãƒƒãƒˆã«å‡ºåŠ›
* node    :          	Hardhat Networkã«å¯¾ã™ã‚‹JSON-RPC server ã®èµ·å‹•
* run     :          	ãƒ¦ãƒ¼ã‚¶å®šç¾©ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å®Ÿè¡Œ
* test    :          	mocha test ã®å®Ÿè¡Œ
* verify  :           Etherscan ã‚„ Sourcify ã‚’åˆ©ç”¨ã—ãŸã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®æ¤œè¨¼
* ignition:		        hardhat Ignitionã‚’åˆ©ç”¨ã—ãŸã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®ãƒ‡ãƒ—ãƒ­ã‚¤


## <a id="compile">ã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®ä½œæˆã¨ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«</a>

* ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆãƒ»ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹

### Solidity ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ä½œæˆ

* contractãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ä¸‹ã« Solidityè¨€èªã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™ï¼
* ã“ã“ã§ã¯, Token.sol ã¨ã„ã†ãƒ•ã‚¡ã‚¤ãƒ«åã«ã—ã¾ã™.
* Solidityãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã«ã¯ .sol ã¨ã„ã†æ‹¡å¼µå­ã‚’ã¤ã‘ã¾ã™ï¼

#### ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®å†…å®¹

* ãƒãƒƒãƒ—ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç”Ÿæˆã—
* ãƒãƒƒãƒ—ã®æ›´æ–°ã«ã‚ˆã£ã¦ã‚¢ã‚«ã‚¦ãƒ³ãƒˆé–“ã§ãƒˆãƒ¼ã‚¯ãƒ³ã®é€é‡‘ã‚’è¡Œã†

â˜… nano ã‚¨ãƒ‡ã‚£ã‚¿ã§ã¯ãªã VScode ã‚’åˆ©ç”¨ã—ã¦ã‚‚è‰¯ã„ã§ã™ï¼

```bash
nano contracts/Token.sol
```
ãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹

* å˜ç´”ã«ã‚³ãƒ”ãƒ¼ï¼ãƒšãƒ¼ã‚¹ãƒˆã™ã‚‹ã®ã§ã¯ãªãï¼Œã™ã¹ã¦ã®è¡Œã‚’èª­ã‚“ã§ãã ã•ã„
* ç‰¹ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’ã‚ˆãèª­ã‚“ã§ãã ã•ã„

```js
//SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;

// Token ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®å®šç¾©
contract Token {
    // ãƒˆãƒ¼ã‚¯ãƒ³åã¨é€šè²¨è¨˜å·
    string public name = "Kindai Token";
    string public symbol = "KDT";
    // ãƒˆãƒ¼ã‚¯ãƒ³ã®ç™ºè¡Œç·é‡
    uint256 public totalSupply = 1000000;
    // æœ€åˆã®æ‰€æœ‰è€…ï¼ˆç™ºè¡Œè€…ï¼‰ã®ã‚¢ãƒ‰ãƒ¬ã‚¹
    address public owner;
    // ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã”ã¨ã®ãƒˆãƒ¼ã‚¯ãƒ³ã®æ‰€æŒé‡‘æ®‹é«˜ã‚’ç®¡ç†ã™ã‚‹ãƒãƒƒãƒ—
    mapping(address => uint256) balances;
    // å¤–éƒ¨ã«ã“ã®ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã«ã‚ˆã‚‹é€é‡‘ã®ç™ºç”Ÿã‚’ä¼ãˆã‚‹ãŸã‚ã®ã‚¤ãƒ™ãƒ³ãƒˆ
    // indexed ã‚’ä»˜ã‘ã‚‹ã“ã¨ã§é€é‡‘è€…ã‚„å—é ˜è€…ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã§ã‚¤ãƒ™ãƒ³ãƒˆã‚’æ¤œç´¢ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹
    event Transfer(address indexed _from, address indexed _to, uint256 _value);

    /**
     * ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã«ã‚ˆã‚‹ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®åˆæœŸåŒ–
     */
    constructor() {
        // ãƒˆãƒ¼ã‚¯ãƒ³ã®ç·é‡ãŒã“ã®ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã®é€ä¿¡è€…ã«å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹
        balances[msg.sender] = totalSupply;
        owner = msg.sender;
    }

    /**
     * ãƒˆãƒ¼ã‚¯ãƒ³ã‚’é€é‡‘ã™ã‚‹é–¢æ•°
     *
     * `external` ã®æŒ‡å®šã«ã‚ˆã‚Šã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®å¤–éƒ¨ã‹ã‚‰ã®ã¿ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ãªé–¢æ•°
     */
    function transfer(address to, uint256 amount) external {
        // ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã®é€é‡‘è€…ãŒååˆ†ãªãƒˆãƒ¼ã‚¯ãƒ³æ®‹é«˜ã‚’æŒã£ã¦ã„ã‚‹ã“ã¨ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹
        // æ®‹é«˜ä¸ååˆ†ãªã‚‰å¤±æ•—ã™ã‚‹
        require(balances[msg.sender] >= amount, "Insufficient balance");

        // æŒ‡å®šã—ãŸé‡‘é¡ã‚’é€é‡‘è€…ã®æ‰€æŒé‡‘ã‹ã‚‰æ¸›é¡ã—é€é‡‘å…ˆã®æ‰€æŒé‡‘ã‚’å¢—é¡ã™ã‚‹
        balances[msg.sender] -= amount;
        balances[to] += amount;

        // å‡¦ç†çµæœã‚’å¤–éƒ¨ã«é€šçŸ¥ã™ã‚‹ã‚¤ãƒ™ãƒ³ãƒˆ
        emit Transfer(msg.sender, to, amount);
    }

    /**
     * ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ãƒˆãƒ¼ã‚¯ãƒ³æ®‹é«˜ã‚’çŸ¥ã‚‹ãŸã‚ã®èª­ã¿ã ã—å°‚ç”¨é–¢æ•°
     * `view` ã®æŒ‡å®šã«ã‚ˆã‚Šã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®çŠ¶æ…‹ã‚’æ›´æ–°ã§ããªã„
     */
    function balanceOf(address account) external view returns (uint256) {
        return balances[account];
    }
}
```

nano ã‚¨ãƒ‡ã‚£ã‚¿ã®æ“ä½œ

* ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ï¼š`<ctrl o>` ã§ä¿å­˜å…ˆãƒ•ã‚¡ã‚¤ãƒ«åã‚’ç¢ºèªã—ã¦ `<Enter>` ã§ä¿å­˜
* ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ï¼š`<ctrl x>` ã§ nano ã‚¨ãƒ‡ã‚£ã‚¿çµ‚äº†

### ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«

ä»¥ä¸‹ã® hardhat ã® compile ã‚¿ã‚¹ã‚¯ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„

```bash
npx hardhat compile

=>
Compiled 1 Solidity file successfully (evm target: paris).
```

### ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«çµæœã®ç¢ºèª


#### artifacts ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª

* ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«çµæœã®ABIã‚„ãƒã‚¤ãƒˆã‚³ãƒ¼ãƒ‰ãªã©ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯ artifacts ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«æ ¼ç´ã•ã‚Œã¾ã™

artifacts ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä»¥ä¸‹ã‚’3éšå±¤ã¾ã§æœ¨æ§‹é€ è¡¨ç¤ºã•ã›ã‚‹ã¨ä»¥ä¸‹ã®ã‚ˆã†ãªæ§‹é€ ãŒè¦‹ãˆã¾ã™

```bash
 tree artifacts -L 3 

=>
artifacts
â”œâ”€â”€ build-info
â”‚Â Â  â””â”€â”€ 3bbdeea033514ca538b39c745e3e170d.json
â””â”€â”€ contracts
    â””â”€â”€ Token.sol
        â”œâ”€â”€ Token.dbg.json
        â””â”€â”€ Token.json

4 directories, 3 files
```


#### ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«çµæœã®ãƒ•ã‚¡ã‚¤ãƒ«

artifacts/contracts ã®ä¸‹ã«ã‚ã‚‹ `'ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆå.sol` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ä¸‹ã® `ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆå.json` ã«JSONå½¢å¼ã«ãªã£ãŸã‚³ãƒ³ãƒ‘ã‚¤ãƒ«çµæœãŒã‚ã‚Šã¾ã™ï¼

```bash
cat artifacts/contracts/Token.sol/Token.json

=>
{
  "_format": "hh-sol-artifact-1",
  "contractName": "Token",
  "sourceName": "contracts/Token.sol",
  "abi": [
    {
      "inputs": [],
      "stateMutability": "nonpayable",
      "type": "constructor"
    },

...

```

## <a id="test"> ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®ãƒ†ã‚¹ãƒˆ</a>

* ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®æ“ä½œã¯ï¼Œethere.js ã‚’åˆ©ç”¨ã—ã¾ã™
* ãƒ†ã‚¹ãƒˆå®Ÿè¡Œã¯ JavaScript ã®ãƒ†ã‚¹ãƒˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ Chai ã¨ Mocha ã‚’åˆ©ç”¨ã—ã¾ã™ï¼

### Chai.js ã«ã‚ˆã‚‹ãƒ†ã‚¹ãƒˆã®ã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³ã®è¨˜è¿°æ–¹æ³•

should , expect, assert ã®ï¼“ã‚¿ã‚¤ãƒ—ã®ãƒ†ã‚¹ãƒˆã®æµå„€ãŒåˆ©ç”¨å¯èƒ½

#### expect ã‚¿ã‚¤ãƒ—ã®å ´åˆ

* ãƒ¡ã‚½ãƒƒãƒ‰ãƒã‚§ãƒ¼ãƒ³(ä»¥ä¸‹ã®ãƒ¡ã‚½ãƒƒãƒ‰ã¯èª­ã¿ã‚„ã™ã•ã®ãŸã‚ã®ã‚‚ã®ã§ï¼Œå‡¦ç†ã®é€£é–ä»¥å¤–ã®æ„å‘³ã¯ç„¡ã„ï¼‰
to
be
does
have
and
...

* equal() : ç­‰ã—ã„
* a(å‹)/an(å‹) : å‹ãƒã‚§ãƒƒã‚¯
* include() ï¼šå«ã‚€
* not ï¼š ãã‚Œä»¥é™ã®å¦å®š
* true ï¼š trueã«ãªã‚‹
* false ï¼š falseã«ãªã‚‹
* within(é–‹å§‹, çµ‚äº†) : é–‹å§‹ã‹ã‚‰çµ‚äº†ã®é–“ 

```js
expect(x).to.equal(2);  		  // xã¯2ã«ç­‰ã—ã„
expect(x).to.be.a('string');  	// x ã¯stringå‹
expect(x).to.be.an('array');  	// x ã¯arrayå‹
expect(x).to.include(3);  		// xã¯3ã‚’å«ã‚€
expect(x).to.does.not.include(3);  // xã¯3ã‚’å«ã¾ãªã„
expect(x).to.be.true			  // xã¯ true
expect(x).to.be.false		    // xã¯ false
```

### Mocha ã«ã‚ˆã‚‹ãƒ†ã‚¹ãƒˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã®è¨˜è¿°

* ãƒ†ã‚¹ãƒˆã®å®šç¾©(describe)(
  * äº‹å‰æ¡ä»¶(before)
     * å€‹åˆ¥ã®ã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³ã®äº‹å‰æ¡ä»¶(beforeEach)
     * å€‹åˆ¥ã®ã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³(it) 
     * å€‹åˆ¥ã®ã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³ã®äº‹å‰æ¡ä»¶(afterEach)
  * çµæœ(after)
* )

#### Mochaã®æ–‡æ³•

* describe()	:ãƒ†ã‚¹ãƒˆã®å®šç¾©
* before()	ï¼šäº‹å‰æ¡ä»¶
* after()            : äº‹å¾Œæ¡ä»¶
* it()		ï¼šå€‹åˆ¥ã®ã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³
* beforeEach() ï¼šå€‹åˆ¥ã®ã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³ã®äº‹å‰å‡¦ç†
* afterEach()    ï¼šå€‹åˆ¥ã®ã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³ã®äº‹å¾Œå‡¦ç†


#### Mocha ã«ã‚ˆã‚‹ãƒ†ã‚¹ãƒˆã®ä¾‹

```js
describe("ã¹ãä¹—é–¢æ•° pow", function() {
  it("2ã®0ä¹—ã¯1", function() {
    assert(math.pow(2, 0)==1);
  });
  it("2ã®3ä¹—ã¯8", function() {
    assert(math.pow(2, 3)==(8));
  });
  it("2ã®-2ä¹—ã¯0.25", function() {
    assert(math.pow(2, -2)==0.25);
  });
});

```

### ethers.js (v6ç³») ã‚’ä½¿ã£ãŸã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®ãƒ‡ãƒ—ãƒ­ã‚¤

* ethers.deployContract é–¢æ•°

```js
const contract = await ethers.deployContract(abi, contract,[args])
```

ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®ABIã‚„ãƒã‚¤ãƒˆã‚³ãƒ¼ãƒ‰ã¨åˆæœŸå€¤ã‚’å…¥ã‚Œã¦ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³åŒ–
ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã‚’ãƒ–ãƒ­ãƒ¼ãƒ‰ã‚­ãƒ£ã‚¹ãƒˆã—ã¦ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹

  * å¼•æ•°
    * ABI
    * ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆ
    * ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã®åˆæœŸå€¤ã®é…åˆ—: []
  * è¿”ã‚Šå€¤
    *ãƒ‡ãƒ—ãƒ­ã‚¤ã—ãŸãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã®ãƒãƒƒã‚·ãƒ¥å€¤

### Hardhat Toolbox ã®åˆ©ç”¨

hardhat ã«ã¯ etheres.js ã‚’åˆ©ç”¨ã—ã¦é–‹ç™ºã™ã‚‹ãŸã‚ã®å„ç¨®ãƒ„ãƒ¼ãƒ«ãŒå‚™ã‚ã£ã¦ã„ã¾ã™ï¼

[Hardhat Toolbox](https://hardhat.org/hardhat-runner/plugins/nomicfoundation-hardhat-toolbox)


* test ã‚„ãƒ‡ãƒ—ãƒ­ã‚¤ã«ã¯ï¼Œhardhat toolbox ã‚’åˆ©ç”¨ã™ã‚‹ã®ãŒä¾¿åˆ©ã§ã™


## ãƒ†ã‚¹ãƒˆãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ä½œæˆ

* ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã®ä¸‹ã« test ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ãƒ†ã‚¹ãƒˆãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ä½œæˆã—ã¾ã™
* hardhat ã§ã¯ï¼Œchai ã‚’ ES6ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼ˆcommonJSãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼‰ã§ã¯ãªã Node.js ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¨ã—ã¦ require ã§èª­ã¿è¾¼ã‚€ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„

* Token.js 

```bash
nano test/Token.js
```

* hardhat toolbox ã® loadFixture ã‚’åˆ©ç”¨ã—ã¾ã™ï¼
* ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®ãƒ‡ãƒ—ãƒ­ã‚¤ã¨ãƒ†ã‚¹ãƒˆç”¨ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ç”Ÿæˆã™ã‚‹å‡¦ç†ã‚’é–¢æ•°ã¨ã—ã¦å®šç¾©ã—ã¦ã„ã¾ã™
* it ã«ã‚ˆã‚‹ãƒ†ã‚¹ãƒˆé …ç›®ã”ã¨ã«ä¸Šè¨˜ã®é–¢æ•°ã¨ loadFixture ã§ãƒ†ã‚¹ãƒˆç’°å¢ƒã‚’åˆæœŸåŒ–ã—ã¾ã™

```js
// hardhat tool box ã® loadFixture åˆ©ç”¨
const {loadFixture} = require("@nomicfoundation/hardhat-toolbox/network-helpers");
// Chaiã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’åˆ©ç”¨
const { expect } = require("chai");

describe("Tokenã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®ãƒ†ã‚¹ãƒˆ", function () {
  // Token ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®ãƒ‡ãƒ—ãƒ­ã‚¤ã¨ãƒ†ã‚¹ãƒˆç”¨ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’æº–å‚™ã™ã‚‹é–¢æ•°
  async function deployTokenFixture() {
    // ãƒ†ã‚¹ãƒˆç”¨ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®å–å¾—ï¼ˆethers.getSigners() ã¯ã‚¢ã‚«ã‚¦ãƒ³ãƒˆå–å¾—ç”¨é–¢æ•°ï¼‰
    const [owner, addr1, addr2] = await ethers.getSigners();
    // ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹
    const Token = await ethers.deployContract("Token");
    // ãƒ†ã‚¹ãƒˆç”¨ãƒ•ã‚£ã‚¯ã‚¹ãƒãƒ£
    return { Token, owner, addr1, addr2 };
  }
  it("ãƒ‡ãƒ—ãƒ­ã‚¤ã«ã‚ˆã‚Šãƒˆãƒ¼ã‚¯ãƒ³ã®ç·é‡ãŒæ‰€æœ‰è€…ã«å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ã“ã¨", async function () {
    // Token ãƒ†ã‚¹ãƒˆç”¨ãƒ•ã‚£ã‚¯ã‚¹ãƒãƒ£ã‚’ãƒ­ãƒ¼ãƒ‰ã™ã‚‹
    const {Token, owner, addr1, addr2} = await loadFixture(deployTokenFixture);
    // ã‚ªãƒ¼ãƒŠãƒ¼ã®æ‰€æŒé‡‘ã®åˆæœŸå€¤
    const ownerBalance = await Token.balanceOf(owner.address);
    // ãƒˆãƒ¼ã‚¯ãƒ³ã®ç·é‡ãŒã‚ªãƒ¼ãƒŠãƒ¼ã®æ‰€æŒé‡‘ã®åˆæœŸå€¤ã¨ç­‰ã—ã„ã“ã¨ã®ç¢ºèª
    expect(await Token.totalSupply()).to.equal(ownerBalance);
  });
});
```

* ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ï¼š`<ctrl o>` ã§ä¿å­˜å…ˆãƒ•ã‚¡ã‚¤ãƒ«åã‚’ç¢ºèªã—ã¦ `<Enter>` ã§ä¿å­˜
* ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ï¼š`<ctrl x>` ã§ nano ã‚¨ãƒ‡ã‚£ã‚¿çµ‚äº†


### ãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œ

* ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã‹ã‚‰ hardhat ã®ãƒ†ã‚¹ãƒˆã‚¿ã‚¹ã‚¯ã‚’å®Ÿè¡Œã—ã¾ã™

```bash
npx hardhat test
=>

  ãƒˆãƒ¼ã‚¯ãƒ³ã®ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆ
    âœ” ãƒ‡ãƒ—ãƒ­ã‚¤ã«ã‚ˆã‚Šãƒˆãƒ¼ã‚¯ãƒ³ã®ç·ä¾›çµ¦é‡ãŒæ‰€æœ‰è€…ã«å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ã“ã¨(435ms)


  1 passing (436ms)
```

### ãƒ†ã‚¹ãƒˆãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®å†…å®¹ã®èª¬æ˜

* ethers ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯ï¼Œãƒ©ãƒƒãƒ”ãƒ³ã‚°ãƒ©ã‚¤ãƒ–ãƒ©ãƒª ethers.js ã‚’æ„å‘³ã—ã¾ã™ï¼
* ethers.getSigners() ã¯ï¼Œãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³é€ä¿¡è€…ï¼ˆç½²åè€…ï¼‰ã®Ethereumã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’è¿”ã™ãƒ¡ã‚½ãƒƒãƒ‰ã§ã™ï¼

```js
const [owner] = await ethers.getSigners();
```
* ethers.deployContract()  ã¯ï¼Œå¼•æ•°ã®ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ ethers.js ãƒ¡ã‚½ãƒƒãƒ‰ã§ã™ï¼
* ãƒ‡ãƒ—ãƒ­ã‚¤ãŒå®Œäº†ã™ã‚‹ã¨ Token ã¨ã„ã†ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒåˆ©ç”¨å¯èƒ½ã«ãªã‚Šã¾ã™ï¼

```js
const Token = await ethers.deployContract("Token");
```
* ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ Tokenã«å¯¾ã—ã¦ balanceOf ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ã†ã¨ Owner ã®æ‰€æŒé‡‘ã‚’ç¢ºèªã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼

```js
const ownerBalance = await Token.balanceOf(owner.address);
```
* ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ Token ã«å¯¾ã—ã¦ totalSupply ã¨ã„ã†ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ã£ã¦ãƒˆãƒ¼ã‚¯ãƒ³ã®ç·é‡ã‚’æ±‚ã‚ã¾ã™ï¼
* ã“ã“ã§ã¯ã•ã‚‰ã«ï¼Œãã®å€¤ãŒ Ownerã®æ‰€æŒé‡‘ã¨ç­‰ã—ã„ã“ã¨ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã™ï¼

```js
expect(await Token.totalSupply()).to.equal(ownerBalance);
```

#### ãƒ†ã‚¹ãƒˆã®ä¿®æ­£

```bash
nano test/Token.js
```

```js
// hardhat tool box ã®åˆ©ç”¨
const {loadFixture} = require("@nomicfoundation/hardhat-toolbox/network-helpers");
// CHaiã®åˆ©ç”¨
const { expect } = require("chai");

describe("Tokenã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆ", function () {
  async function deployTokenFixture() {
    // è¤‡æ•°ã®ãƒ†ã‚¹ãƒˆç”¨ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®å–å¾—
    const [owner, addr1, addr2] = await ethers.getSigners();
    // ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹
    const Token = await ethers.deployContract("Token");
    // Tokenãƒ†ã‚¹ãƒˆç”¨ãƒ•ã‚£ã‚¯ã‚¹ãƒãƒ£
    return { Token, owner, addr1, addr2 };
  }

  it("Tokenã®ç·é‡ãŒ owner ã«å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¦ã„ã‚‹ã“ã¨", async function () {
    // Tokenãƒ†ã‚¹ãƒˆç”¨ãƒ•ã‚£ã‚¯ã‚¹ãƒãƒ£ã‚’ãƒ­ãƒ¼ãƒ‰ã™ã‚‹
    const { Token, owner } = await loadFixture(deployTokenFixture);
    // ã‚ªãƒ¼ãƒŠãƒ¼ã®æ‰€æŒé‡‘é¡ã®ç¢ºèª
    const ownerBalance = await Token.balanceOf(owner.address);
    // ãƒˆãƒ¼ã‚¯ãƒ³ã®ç·é¡ã¯ã‚ªãƒ¼ãƒŠãƒ¼ã®æ‰€æŒé‡‘ã«ç­‰ã—ã„
    expect(await Token.totalSupply()).to.equal(ownerBalance);
  });

  it("ã‚¢ã‚«ã‚¦ãƒ³ãƒˆé–“ã§ãƒˆãƒ¼ã‚¯ãƒ³ãŒè»¢é€ã•ã‚Œã‚‹ã“ã¨", async function () {
    // Tokenãƒ†ã‚¹ãƒˆç”¨ãƒ•ã‚£ã‚¯ã‚¹ãƒãƒ£ã‚’ãƒ­ãƒ¼ãƒ‰ã™ã‚‹
    const { Token, owner, addr1, addr2 } = await loadFixture(
      deployTokenFixture
    );

    // 50ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ owner ã‹ã‚‰ addr1 ã«é€é‡‘ã™ã‚‹
    await expect(
      Token.transfer(addr1.address, 50)
    ).to.changeTokenBalances(Token, [owner, addr1], [-50, 50]);

    // 50ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ addr1 ã‹ã‚‰ addr2ã«é€é‡‘ã™ã‚‹
    // ã“ã“ã§ã¯ãƒˆãƒ¼ã‚¯ãƒ³ã®é€é‡‘ã« .connect(signer) ã‚’åˆ©ç”¨ã—ã¦ã„ã‚‹
    await expect(
      Token.connect(addr1).transfer(addr2.address, 50)
    ).to.changeTokenBalances(Token, [addr1, addr2], [-50, 50]);
  });
});

```

* ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ï¼š`<ctrl o>` ã§ä¿å­˜å…ˆãƒ•ã‚¡ã‚¤ãƒ«åã‚’ç¢ºèªã—ã¦ `<Enter>` ã§ä¿å­˜
* ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ï¼š`<ctrl x>` ã§ nano ã‚¨ãƒ‡ã‚£ã‚¿çµ‚äº†

#### ãƒ†ã‚¹ãƒˆã®å†å®Ÿè¡Œ

```bash
npx hardhat test 

=>

  Tokenã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆ
    âœ” Tokenã®ç·é‡ãŒ owner ã«å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¦ã„ã‚‹ã“ã¨ (387ms)
    âœ” ã‚¢ã‚«ã‚¦ãƒ³ãƒˆé–“ã§ãƒˆãƒ¼ã‚¯ãƒ³ãŒè»¢é€ã•ã‚Œã‚‹ã“ã¨


  2 passing (402ms)


```


## <a id="hhNetwork"> Hardhar Networkã®èµ·å‹•</a>

* ã“ã“ã‹ã‚‰æ–°ã—ãåˆ¥ã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚’é–‹ã
* ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã«ç§»å‹•ã™ã‚‹

```bash
cd ~/hardhat/tutorial
```

### hardhat node ã®èµ·å‹•

* è‡ªåˆ†ã®ãƒã‚·ãƒ³ã®ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã«ãƒ†ã‚¹ãƒˆç”¨ã® Ethereum Network Node ã‚’èµ·å‹•ã—ã¾ã™
* è‡ªå‹•çš„ã«20å€‹ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆï¼ˆEOA) ãŒç”Ÿæˆã•ã‚Œã¾ã™
* è‡ªå‹•ç”Ÿæˆã•ã‚ŒãŸã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¯ãã‚Œãã‚Œ 10000 Eth ã®è³‡é‡‘ã‚’æ‰€æœ‰ã—ã¦ã„ã¾ã™

```bash
npx hardhat node

=>
Started HTTP and WebSocket JSON-RPC server at http://127.0.0.1:8545/

Accounts
========

WARNING: These accounts, and their private keys, are publicly known.
Any funds sent to them on Mainnet or any other live network WILL BE LOST.

Account #0: 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266 (10000 ETH)
Private Key: 0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80

...

Account #19: 0x8626f6940E2eb28930eFb4CeF49B2d1F2C9C1199 (10000 ETH)
Private Key: 0xdf57089febbacf7ba0bc227dafbffa9fc08a93fdc68e1e42411a14efcf23656e

WARNING: These accounts, and their private keys, are publicly known.
Any funds sent to them on Mainnet or any other live network WILL BE LOST.

```

* å„ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã¨ç§˜å¯†éµã‚’ç¢ºèªã—ã¦ãã ã•ã„


### ãƒ¡ã‚¿ãƒã‚¹ã‚¯ã®åˆ©ç”¨

æœ‰åãªethrerum ãƒ¯ãƒ¬ãƒƒãƒˆã§ã™

![ãƒ¡ã‚¿ãƒã‚¹ã‚¯](images/metamask1.png)

å·¦ä¸Šã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶šãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’é¸æŠ

![ãƒ¡ã‚¿ãƒã‚¹ã‚¯](images/metamask2.png)

ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’è¿½åŠ ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯

ã€Œãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’æ‰‹å‹•ã§è¿½åŠ ã€ã‚’ã‚¯ãƒªãƒƒã‚¯

* ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯åï¼š hardhat network
* æ–°ã—ã„RPC URLï¼š http://localhost:8545/
* ãƒã‚§ãƒ¼ãƒ³IDï¼š 31337
* é€šè²¨è¨˜å·ï¼š ETH

ã§ã€Œä¿å­˜ã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«æ¥ç¶šã—ã¾ã™

### ãƒ¡ã‚¿ãƒã‚¹ã‚¯ã«ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’å–ã‚Šè¾¼ã‚€

* <img src="images/metamask3.png" width="300">

* <img src="images/metamask4.png" width="300">

* <img src="images/metamask5.png" width="300">

Hardhat node ã®èµ·å‹•ç”»é¢ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ãƒªã‚¹ãƒˆã«ã‚ã‚‹

* Private Key: ç§˜å¯†éµ

ã®ã©ã‚Œã‹ã‚’ç§˜å¯†éµã¨ã—ã¦ã‚³ãƒ”ãƒ¼ã—ã¦ãƒšãƒ¼ã‚¹ãƒˆã—ã¾ã™

* <img src="images/metamask6.png" width="400">



## ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®ãƒ‡ãƒ—ãƒ­ã‚¤

### hardhat ignition ã‚’åˆ©ç”¨ã—ãŸã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®ãƒ‡ãƒ—ãƒ­ã‚¤

* hardhat ignition ã¯ï¼Œãƒ‡ãƒ—ãƒ­ã‚¤ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’æŠ½è±¡åŒ–ã—ï¼Œãƒ‡ãƒ—ãƒ­ã‚¤ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¨ã—ã¦ï¼Œå®£è¨€çš„ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’è¨˜è¿°ã—ã¾ã™

#### Future ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ

* ã“ã®å®£è¨€çš„ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’å®Ÿæ–½ã™ã‚‹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ã“ã¨ã‚’ `Future` ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨å‘¼ã³ã¾ã™
* `Future` ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯ï¼Œå†…éƒ¨çš„ãªãƒ‡ãƒ—ãƒ­ã‚¤å®Ÿæ–½æ–¹æ³•ã®è¡¨ç¾ã§ã‚ã£ã¦ï¼Œãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¸ã®å®Ÿéš›ã®ä½œç”¨ã¯è¡Œã„ã¾ã›ã‚“ï¼

#### buildModule é–¢æ•°

* buildModule é–¢æ•°ã¯ `Future` ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ç”Ÿæˆã™ã‚‹é–¢æ•°ã§ã™ï¼
* ã“ã®é–¢æ•°ã®ï¼Œç¬¬ï¼‘å¼•æ•°ãŒãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åã§ï¼Œç¬¬ï¼’å¼•æ•°ãŒãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’å®šç¾©ã™ã‚‹ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•°ã§ã™ï¼
* `Future` ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ç”Ÿæˆã¯ï¼Œ`contract` ãƒ¡ã‚½ãƒƒãƒ‰ã¨ `call` ãƒ¡ã‚½ãƒƒãƒ‰ã§å®Ÿæ–½ã—ã¾ã™ï¼
* `contract` ãƒ¡ã‚½ãƒƒãƒ‰ã¯ï¼Œã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ãŸã‚ã®æŒ‡ç¤ºã‚’ç”Ÿæˆã—ã¾ã™ï¼
* `call` ãƒ¡ã‚½ãƒƒãƒ‰ã¯ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®é–¢æ•°ã‚’å‘¼ã³å‡ºã™æŒ‡ç¤ºã‚’ç”Ÿæˆã—ã¾ã™ï¼

### ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«

```bash
nano ignition/modules/Token.js
```
  
```js
const { buildModule } = require("@nomicfoundation/hardhat-ignition/modules");

// ã“ã“ã§ã¯ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åã‚’Tutorial ã«ã™ã‚‹ï¼m ãŒãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«ãªã‚‹
module.exports = buildModule("Tutorial", (m) => {
  // ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆåTokenã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«å¯¾ã™ã‚‹ãƒ‡ãƒ—ãƒ­ã‚¤æŒ‡ç¤ºã¨ãªã‚‹ Future ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ç”Ÿæˆ
  // ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã®å¼•æ•°ã¯ç„¡ã„
  const contract = m.contract("Token", []);
  // ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹Future ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’è¿”ã™
  return { contract };
});
```

### ãƒ‡ãƒ—ãƒ­ã‚¤ã®å®Ÿè¡Œ

* æ–°ã—ã„ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆãƒ»ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‹ã‚‰å®Ÿè¡Œ

```bash
npx hardhat ignition deploy ignition/modules/Token.js --network localhost

=>
Hardhat Ignition ğŸš€

Deploying [ Tutorial ]

Batch #1
  Executed Tutorial#Token

[ Tutorial ] successfully deployed ğŸš€

Deployed Addresses

Tutorial#Token - 0x5FbDB2315678afecb367f032d93F642f64180aa3

```

