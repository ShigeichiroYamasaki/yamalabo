# 01. Hardhat 3  ã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«

Ethereum ã®é–‹ç™ºç’°å¢ƒ

2025/08/26
Shigeichiro Yamasaki

hardhat 3 ã¯ï¼Œviem ã¨ã„ã† TypeScript ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’åˆ©ç”¨ã—ã¦EVMã¨å¯¾è©±ã—ã¾ã™ï¼


##  <a id="setup">ç’°å¢ƒã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—</a>

* hardhat node ã¯ãƒ­ãƒ¼ã‚«ãƒ«ãƒã‚·ãƒ³ã§å®Ÿè¡Œã™ã‚‹ã“ã¨ã‚’å‰æã«ã—ã¾ã™
* Node.js ã¨ JavaScriptã®çŸ¥è­˜ãŒå‰æã«ãªã‚Šã¾ã™

### ubuntu

```bash
sudo apt update
sudo apt upgrade -y
sudo apt install -y curl git tree
cd ~
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.40.3/install.sh | bash
\. "$HOME/.nvm/nvm.sh"
source ~/.profile

nvm install node
npm install -g yarn

node -v
=>
v24.6.0
```
* VS code ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
sudo snap install --classic code
```

### MacOSX

```bash
brew update
brew upgrade
brew install curl git tree
source $(brew --prefix nvm)/nvm.sh
echo 'source $(brew --prefix nvm)/nvm.sh' >> ~/.zprofile
source ~/.zprofile

cd ~
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.40.3/install.sh | bash
\. "$HOME/.nvm/nvm.sh"

nvm install node
npm install -g yarn

node -v
=>
v24.6.0
```

* VS code ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

[https://code.visualstudio.com/download](https://code.visualstudio.com/download) ã‹ã‚‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ©ãƒ¼ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰

## <a id="project">Hardhat ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®æ–°è¦ä½œæˆ</a>

### ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ•ã‚©ãƒ«ãƒ€ã®ä½œæˆ

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ•ã‚©ãƒ«ãƒ€ã‚’æ±ºã‚ã¾ã™ï¼

â˜… ã“ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ã€Œãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã€ã¨ã„ã„ã¾ã™ï¼

```bash
cd ~
mkdir hardhat
cd hardhat/
mkdir hardhat-example
cd hardhat-example
```

* ã“ã“ã§ã¯ï¼Œãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã‚’ hardhat-example ã¨ã„ã†åå‰ã®ãƒ•ã‚©ãƒ«ãƒ€ã«ã—ã¾ã™ãŒï¼Œé©å®œè‡ªåˆ†ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåã«ä¿®æ­£ã—ã¦ãã ã•ã„

### VS codeã‚’åˆ©ç”¨ã™ã‚‹å ´åˆ

æ‹¡å¼µæ©Ÿèƒ½ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

* Japanese Language Pack for Visual Studio Code
* Hardhat Developer Pack

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ VS code  ã‹ã‚‰æŒ‡å®š

### JavaScript ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ

init ã‚³ãƒãƒ³ãƒ‰ã§ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ•ã‚©ãƒ«ãƒ€ç¾¤ã‚’è‡ªå‹•ç”Ÿæˆã—ã¾ã™ï¼
ã¾ãŸï¼Œã“ã®ãƒ‘ã‚¹ãŒãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®èµ·ç‚¹ã¨ãªã‚‹ã€Œãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã€ã«ãªã‚Šã¾ã™ï¼
è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã¯ï¼Œpackage.json ã¨ã„ã†ãƒ•ã‚¡ã‚¤ãƒ«ã§ã™ï¼


### Hardhat 3 ã®åˆæœŸåŒ–

åˆæœŸåŒ–ã‚³ãƒãƒ³ãƒ‰

```bash
npx hardhat --init
```
å®Ÿè¡Œå¾Œ

```bash
Need to install the following packages:
hardhat@3.0.1
Ok to proceed? (y) 
```

* ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã® return ã‚­ãƒ¼ã‚’æŠ¼ã™ã¨ï¼Œä»¥ä¸‹ã®ã‚ˆã†ãªè¡¨ç¤ºãŒå‡ºç¾ã—ã¾ã™

```bash
=>
 â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                         â–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆ                  â–ˆâ–ˆâ–ˆ      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
â–‘â–‘â–ˆâ–ˆâ–ˆ  â–‘â–‘â–ˆâ–ˆâ–ˆ                         â–‘â–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆ                 â–‘â–ˆâ–ˆâ–ˆ     â–ˆâ–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆâ–ˆ
 â–‘â–ˆâ–ˆâ–ˆ   â–‘â–ˆâ–ˆâ–ˆ   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–‘â–‘â–‘  â–‘â–ˆ
 â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–‘â–‘â–‘â–‘â–‘â–ˆâ–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆâ–ˆ  â–‘â–‘â–‘â–‘â–‘â–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–ˆâ–ˆâ–ˆâ–‘      â–ˆâ–ˆâ–ˆâ–ˆâ–‘
 â–‘â–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–ˆâ–ˆâ–ˆ   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆ â–‘â–‘â–‘ â–‘â–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆ   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–‘â–ˆâ–ˆâ–ˆ      â–‘â–‘â–‘â–‘â–ˆâ–ˆâ–ˆ
 â–‘â–ˆâ–ˆâ–ˆ   â–‘â–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆ     â–‘â–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆâ–ˆ  â–‘â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆ
 â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–‘â–‘â–ˆâ–ˆ
â–‘â–‘â–‘â–‘â–‘  â–‘â–‘â–‘â–‘â–‘  â–‘â–‘â–‘â–‘â–‘â–‘â–‘ â–‘â–‘â–‘â–‘â–‘      â–‘â–‘â–‘â–‘â–‘â–‘â–‘ â–‘â–‘â–‘â–‘ â–‘â–‘â–‘â–‘â–‘  â–‘â–‘â–‘â–‘â–‘â–‘â–‘    â–‘â–‘â–‘â–‘â–‘   â–‘â–‘â–‘â–‘â–‘â–‘
 
ğŸ‘· Welcome to Hardhat v3.0.1 ğŸ‘·

? Which version of Hardhat would you like to use? â€¦ 
â¯ Hardhat 3 Beta (recommended for new projects)
  Hardhat 2 (older version)

```

* â¯ Hardhat 3 Beta (recommended for new projects) ã‚’é¸æŠã—ï¼Œreturn ã‚­ãƒ¼ã‚’æŠ¼ã™
* ãã®å¾Œã‚‚ï¼ŒãŸã  return ã‚­ãƒ¼ã‚’æŠ¼ã—ã¦ã„ãã¾ã™

### Hardhat 3 ã®ãƒ˜ãƒ«ãƒ—

ä»¥ä¸‹ã®ã‚ˆã†ã«ã—ã¦ help ã‚’ç¢ºèªã§ãã¾ã™

```bash
npx hardhat --help

Hardhat version 3.0.1

Usage: hardhat [GLOBAL OPTIONS] <TASK> [SUBTASK] [TASK OPTIONS] [--] [TASK ARGUMENTS]

AVAILABLE TASKS:

...
```

### hardhat ã®Task 

ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ãªã© Hardhat ã®ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã‹ã‚‰å®Ÿè¡Œã™ã‚‹å‡¦ç†ã®ã“ã¨

å®Ÿè¡Œå½¢å¼  `npx hardhat <ã‚¿ã‚¹ã‚¯>` 


*  build    |         ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã¨artifactsã®æ§‹ç¯‰
*  clean    |         ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚„ artifacts ã®å…¨ãƒ‡ãƒ¼ã‚¿ã®æ¶ˆå»
*  compile  |         ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã¨artifactsã®æ§‹ç¯‰t (alias for build)
*  console  |         hardhat console ã‚’é–‹ã
*  flatten  |         ä¾å­˜é–¢ä¿‚ã®ã‚ã‚‹ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‚³ãƒ¼ãƒ‰ã‚’ã™ã¹ã¦ãƒ•ãƒ©ãƒƒãƒˆã«å‡ºåŠ›
*  node     |         Hardhat Networkã‚µãƒ¼ãƒãƒ¼ã¨JSON-RPCã®èµ·å‹•
*  run      |         ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ¦ãƒ¼ã‚¶å®šç¾©ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å®Ÿè¡Œ
*  telemetry|         è¨­å®šã®æ›´æ–°ã¨ç¢ºèª
*  test     |         ãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œ
*  verify             explorer ã‚’åˆ©ç”¨ã—ãŸã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®æ¤œè¨¼

### ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ

hardhat ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¯ä»¥ä¸‹ã®ã‚ˆã†ãªæ§‹æˆã«ãªã£ã¦ã„ã‚‹

```
tree -L 1
=>
.
â”œâ”€â”€ contracts
â”œâ”€â”€ hardhat.config.ts
â”œâ”€â”€ ignition
â”œâ”€â”€ node_modules
â”œâ”€â”€ package-lock.json
â”œâ”€â”€ package.json
â”œâ”€â”€ README.md
â”œâ”€â”€ scripts
â”œâ”€â”€ test
â””â”€â”€ tsconfig.json

6 directories, 5 files
```

ã•ã‚‰ã«ãã®ä¸‹ã®æ§‹é€ ã‚’ç¢ºèªã—ã¦ãã ã•ã„

```bash
tree contracts -L 1
contracts
â”œâ”€â”€ Counter.sol
â””â”€â”€ Counter.t.sol

tree test -L 1     
test
â””â”€â”€ Counter.ts

tree ignition -L 1 
ignition
â””â”€â”€ modules

tree scripts -L 1 
scripts
â””â”€â”€ send-op-tx.ts
```


## <a id="compile">ã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®ä½œæˆã¨ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«</a>

* ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆãƒ»ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹

### Solidity ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ä½œæˆ ï¼ˆcontracts/Counter.solï¼‰

* contractãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ä¸‹ã« Solidityè¨€èªã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™ï¼
* ã“ã“ã§ã¯, ã‚µãƒ³ãƒ—ãƒ«ã¨ã—ã¦è‡ªå‹•ç”Ÿæˆã•ã‚Œã¦ã„ã‚‹ Counter.sol ã¨ã„ã†ãƒ•ã‚¡ã‚¤ãƒ«åã®ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‚’åˆ©ç”¨ã—ã¾ã™.
* Solidityãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã«ã¯ .sol ã¨ã„ã†æ‹¡å¼µå­ã‚’ã¤ã‘ã¾ã™ï¼

contracts/Counter.sol

```js
// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.8.28;

contract Counter {
  uint public x;

  event Increment(uint by);

  function inc() public {
    x++;
    emit Increment(1);
  }

  function incBy(uint by) public {
    require(by > 0, "incBy: increment should be positive");
    x += by;
    emit Increment(by);
  }
}

```


### ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«

ä»¥ä¸‹ã® hardhat ã® compile ã‚¿ã‚¹ã‚¯ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„

```bash
npx hardhat build
=>
Compiling your Solidity contracts...
Compiled 1 Solidity file with solc 0.8.28 (evm target: cancun)
```

### ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«çµæœã®ç¢ºèª

#### artifacts ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª

* ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«çµæœã®ABIã‚„ãƒã‚¤ãƒˆã‚³ãƒ¼ãƒ‰ãªã©ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯ artifacts ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«æ ¼ç´ã•ã‚Œã¾ã™

artifacts ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä»¥ä¸‹ã‚’3éšå±¤ã¾ã§æœ¨æ§‹é€ è¡¨ç¤ºã•ã›ã‚‹ã¨ä»¥ä¸‹ã®ã‚ˆã†ãªæ§‹é€ ãŒè¦‹ãˆã¾ã™

```bash
tree artifacts -L 3
=>
artifacts
â”œâ”€â”€ artifacts.d.ts
â”œâ”€â”€ build-info
â”‚Â Â  â”œâ”€â”€ solc-0_8_28-f51ae87ae795dce4b7c7ed5c8b1e794e7ad8d02a.json
â”‚Â Â  â””â”€â”€ solc-0_8_28-f51ae87ae795dce4b7c7ed5c8b1e794e7ad8d02a.output.json
â””â”€â”€ contracts
    â””â”€â”€ Counter.sol
        â”œâ”€â”€ artifacts.d.ts
        â””â”€â”€ Counter.json
```


#### ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«çµæœã®ãƒ•ã‚¡ã‚¤ãƒ«

artifacts/contracts ã®ä¸‹ã«ã‚ã‚‹ `'ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆå.sol` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ä¸‹ã® `ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆå.json` ã«JSONå½¢å¼ã«ãªã£ãŸã‚³ãƒ³ãƒ‘ã‚¤ãƒ«çµæœãŒã‚ã‚Šã¾ã™ï¼

```bash
cat artifacts/contracts/Counter.sol/Counter.json 
=>
{
  "_format": "hh3-artifact-1",
  "contractName": "Counter",
  "sourceName": "contracts/Counter.sol",
  "abi": [
    {
      "anonymous": false,
      "inputs": [
        {
          "indexed": false,
          "internalType": "uint256",
          "name": "by",
          "type": "uint256"
        }
      ],


...

```

## <a id="test"> ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®ãƒ†ã‚¹ãƒˆ</a>

hardhat 3 ã‹ã‚‰ï¼Œsolidity ã¨ TypeSctipt ã§ãƒ†ã‚¹ãƒˆè¨˜è¿°ã™ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸï¼


### Solidity ã«ã‚ˆã‚‹ãƒ†ã‚¹ãƒˆ

ãƒ†ã‚¹ãƒˆãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¯ï¼Œãƒ•ã‚¡ã‚¤ãƒ«åã®æ‹¡å¼µå­ãŒ `.t.sol` ã«ãªã‚Šã¾ã™

* contract/Counter.t.sol

```solidity
// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.8.28;

import {Counter} from "./Counter.sol";
import {Test} from "forge-std/Test.sol";

contract CounterTest is Test {
  Counter counter;

  function setUp() public {
    counter = new Counter();
  }

  function test_InitialValue() public view {
    require(counter.x() == 0, "Initial value should be 0");
  }

  function testFuzz_Inc(uint8 x) public {
    for (uint8 i = 0; i < x; i++) {
      counter.inc();
    }
    require(counter.x() == x, "Value after calling inc x times should be x");
  }

  function test_IncByZero() public {
    vm.expectRevert();
    counter.incBy(0);
  }
}

```

#### ã“ã®ãƒ†ã‚¹ãƒˆãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®æ¦‚è¦

* unit ãƒ†ã‚¹ãƒˆ
  * test_InitialValue é–¢æ•°ã¨ test_IncByZero é–¢æ•°
  * ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒç„¡ãï¼Œãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œã¯1å›ã ã‘
* fuzz ãƒ†ã‚¹ãƒˆ
  * testFuzz_Inc é–¢æ•°
  * ãƒ©ãƒ³ãƒ€ãƒ ãªå…¥åŠ›ã‚’å…¥ã‚Œã¦è¤‡æ•°å›ãƒ†ã‚¹ãƒˆãŒå®Ÿè¡Œã•ã‚Œã‚‹
  * ãƒ†ã‚¹ãƒˆãŒå¤±æ•—ã—ãŸã¨ãã¯ï¼Œãã®ã‚¤ãƒ³ãƒ—ãƒƒãƒˆãŒç¤ºã•ã‚Œã‚‹


#### ãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œ

ä»¥ä¸‹ã®ã‚ˆã†ã«ãƒ†ã‚¹ãƒˆã™ã‚‹ã¨ï¼Œã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆãŒå®Ÿè¡Œã•ã‚Œã¾ã™

```bash
npx hardhat test
=>
Compiling your Solidity contracts...

Nothing to compile

Running Solidity tests

  contracts/Counter.t.sol:CounterTest
    âœ” test_InitialValue()
    âœ” test_IncByZero()
    âœ” testFuzz_Inc(uint8) (runs: 256)


  3 passing

Running node:test tests

  Counter
    âœ” Should emit the Increment event when calling the inc() function
    âœ” The sum of the Increment events should match the current value


  2 passing (1435ms)

```

#### ãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œå†…å®¹

1. ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã¨ãƒ†ã‚¹ãƒˆã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«
2. test/ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ä¸‹ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒçµ±åˆã•ã‚Œã‚‹
3. ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‚„ãƒ†ã‚¹ãƒˆãŒãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚Œã‚‹
4. ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆãŒå®Ÿæ–½ã•ã‚Œï¼Œå¤±æ•—ã—ã¦ã„ã‚‹ãƒ†ã‚¹ãƒˆé …ç›®ã¯ failed ã¨è¨˜è¼‰ã•ã‚Œã‚‹


#### solidity ã®ãƒ†ã‚¹ãƒˆã®ã¿ã‚’è¡Œã†å ´åˆ

```bash
npx hardhat test solidity
Compiling your Solidity contracts...

Nothing to compile
Running Solidity tests

  contracts/Counter.t.sol:CounterTest
    âœ” test_InitialValue()
    âœ” test_IncByZero()
    âœ” testFuzz_Inc(uint8) (runs: 256)


  3 passingÃ¥
```



### TypeScript ãƒ†ã‚¹ãƒˆ

solidityã«ã‚ˆã‚‹ãƒ†ã‚¹ãƒˆã¯ï¼ŒEVM ã§ï¼Œå®Ÿéš›ã®å‹•ã‹ã™ã“ã¨ãŒã§ãã‚‹ã¨ã„ã†åˆ©ç‚¹ãŒã‚ã‚Šã¾ã™ï¼

ã—ã‹ã—ï¼Œsolidity è¨€èªã¯ãƒ†ã‚¹ãƒˆç”¨è¨€èªã¨ã—ã¦ã¯è¨˜è¿°åŠ›ãŒè²§å¼±ã§ã™ï¼
ä¾‹ãˆã°ï¼ŒéåŒæœŸå‡¦ç†ã®ãƒ†ã‚¹ãƒˆãªã©ã¯ã§ãã¾ã›ã‚“ï¼
TypeScript ã®ãƒ†ã‚¹ãƒˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’åˆ©ç”¨ã—ã¦è£œå¼·ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼

TypeScript ã®ãƒ†ã‚¹ãƒˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã§ã‚ã‚‹ [Node.js test runner](https://nodejs.org/api/test.html) ã‚’åˆ©ç”¨ã—ãŸãƒ†ã‚¹ãƒˆãŒã§ãã¾ã™

#### Node.js test runner ã®åŸºæœ¬

* åå‰ä»˜ããƒ†ã‚¹ãƒˆ

```ts
test("è¶³ã—ç®—", () => {
  assert.equal(1 + 2, 3);
});
```

* éåŒæœŸãƒ†ã‚¹ãƒˆ

```ts
test("éåŒæœŸ", async () => {
  const v = await Promise.resolve(42);
  assert.equal(v, 42);
});
```

* ã‚µãƒ–ãƒ†ã‚¹ãƒˆ

```ts
test("é…åˆ—æ“ä½œ (with hooks)", async (t) => {
  let arr: number[];

  await t.beforeEach(() => { arr = [1, 2, 3]; });
  await t.afterEach(() => { arr = []; });

  await t.test("push", () => {
    arr.push(4);
    assert.deepEqual(arr, [1, 2, 3, 4]);
  });

  await t.test("length", () => {
    assert.equal(arr.length, 3);
  });
});
```

### test/Counter.ts ã®ä¾‹

```ts
// We don't have Ethereum specific assertions in Hardhat 3 yet
import assert from "node:assert/strict";
import { describe, it } from "node:test";

import { network } from "hardhat";

describe("Counter", async function () {
  const { viem } = await network.connect();
  const publicClient = await viem.getPublicClient();

  it("Should emit the Increment event when calling the inc() function", async function () {
    const counter = await viem.deployContract("Counter");

    await viem.assertions.emitWithArgs(
      counter.write.inc(),
      counter,
      "Increment",
      [1n],
    );
  });

  it("The sum of the Increment events should match the current value", async function () {
    const counter = await viem.deployContract("Counter");
    const deploymentBlockNumber = await publicClient.getBlockNumber();

    // run a series of increments
    for (let i = 1n; i <= 10n; i++) {
      await counter.write.incBy([i]);
    }

    const events = await publicClient.getContractEvents({
      address: counter.address,
      abi: counter.abi,
      eventName: "Increment",
      fromBlock: deploymentBlockNumber,
      strict: true,
    });

    // check that the aggregated events match the current value
    let total = 0n;
    for (const event of events) {
      total += event.args.by;
    }

    assert.equal(total, await counter.read.x());
  });
});

```

#### TypeScriptãƒ†ã‚¹ãƒˆã®ã¿ã®å®Ÿè¡Œ

```bash
npx hardhat test nodejs
=>
Compiling your Solidity contracts...

Nothing to compile

Running node:test tests

  Counter
    âœ” Should emit the Increment event when calling the inc() function
    âœ” The sum of the Increment events should match the current value


  2 passing (1591ms)

```


### ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ãƒ¼ãƒ³ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¨å¯¾è©±ã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

`scripts` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«è¨˜è¿°ã™ã‚‹ TypeScript ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ãƒ¼ãƒ³ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¨å¯¾è©±ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™

* cripts/send-op-tx.ts ã®ä¾‹

```ts
import { network } from "hardhat";

const { viem } = await network.connect({
  network: "hardhatOp",
  chainType: "op",
});

console.log("Sending transaction using the OP chain type");

const publicClient = await viem.getPublicClient();
const [senderClient] = await viem.getWalletClients();

console.log("Sending 1 wei from", senderClient.account.address, "to itself");

const l1Gas = await publicClient.estimateL1Gas({
  account: senderClient.account.address,
  to: senderClient.account.address,
  value: 1n,
});

console.log("Estimated L1 gas:", l1Gas);

console.log("Sending L2 transaction");
const tx = await senderClient.sendTransaction({
  to: senderClient.account.address,
  value: 1n,
});

await publicClient.waitForTransactionReceipt({ hash: tx });

console.log("Transaction sent successfully");

```

* ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å®Ÿè¡Œ

```bash
npx hardhat run scripts/send-op-tx.ts
=>
Compiling your Solidity contracts...

Nothing to compile

Sending transaction using the OP chain type
Sending 1 wei from 0xf39fd6e51aad88f6f4ce6ab8827279cfffb92266 to itself
Estimated L1 gas: 1600n
Sending L2 transaction
Transaction sent successfully
```

## ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®ãƒ‡ãƒ—ãƒ­ã‚¤

hardhat ã«ã¯ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’å®£è¨€çš„ã«è¨˜è¿°ã§ãã‚‹ Hardhat Ignition ã¨ã„ã†ã‚·ã‚¹ãƒ†ãƒ ãŒã‚ã‚Šã¾ã™ï¼

ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®ãƒ‡ãƒ—ãƒ­ã‚¤ã®å®šç¾©ã¯ Ignition Module ã«ã‚ˆã£ã¦å®Ÿç¾ã•ã‚Œã¦ã„ã¾ã™ï¼

* Ignition module ã¯ï¼Œ`ignition/modules/` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«å®šç¾©ã—ã¾ã™
* ignition/modules/Counter.ts ã®ä¾‹

```ts
import { buildModule } from "@nomicfoundation/hardhat-ignition/modules";

export default buildModule("CounterModule", (m) => {
  const counter = m.contract("Counter");

  m.call(counter, "incBy", [5n]);

  return { counter };
});

```

ã“ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã® `m.call()` ã‚„ `m.contract()` ã¯ï¼Œãƒ‡ãƒ—ãƒ­ã‚¤ã‚’å®Ÿè¡Œã™ã‚‹é–¢æ•°ã§ã™ï¼

[ignition module å®šç¾©ã®è©³ã—ã„èª¬æ˜](https://hardhat.org/ignition/docs/guides/creating-modules)


* ãƒ‡ãƒ—ãƒ­ã‚¤ã®å®Ÿè¡Œ

```bash
npx hardhat ignition deploy ignition/modules/Counter.ts
=>
You are running Hardhat Ignition against an in-process instance of Hardhat Network.
This will execute the deployment, but the results will be lost.
You can use --network <network-name> to deploy to a different network.

Hardhat Ignition ğŸš€

Deploying [ CounterModule ]

Batch #1
  Executed CounterModule#Counter

Batch #2
  Executed CounterModule#Counter.incBy

[ CounterModule ] successfully deployed ğŸš€

Deployed Addresses

```

ã“ã®ä¾‹ã§ã¯ï¼Œã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã¯ Hardhat Network ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚Œã¦ã„ã¾ã™ãŒï¼Œãƒ¡ã‚¤ãƒ³ãƒãƒƒãƒˆã‚„ãƒ†ã‚¹ãƒˆãƒãƒƒãƒˆãªã©ä»–ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤ã‚‚å¯èƒ½ã§ã™ï¼


## Solidityã«ã‚ˆã‚‹ãƒ†ã‚¹ãƒˆã®è¨˜è¿°æ–¹æ³•

### Solidityãƒ†ã‚¹ãƒˆãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®è¨˜è¿°å ´æ‰€

* test/ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å ´åˆï¼š æ‹¡å¼µå­ .sol
* ontracts/ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å ´åˆï¼š æ‹¡å¼µå­ .t.sol

ä¾‹ãˆã° `contracts/CounterTest.t.sol` ã‚ã‚‹ã„ã¯ `test/CounterTest.sol` ã¨ã„ã†ãƒ†ã‚¹ãƒˆãƒ—ãƒ­ã‚°ãƒ©ãƒ ãŒå­˜åœ¨ã—ãŸå ´åˆ

```solidity
contract CounterTest {
    function testInc() public {
        Counter counter = new Counter();
        counter.inc();
        require(counter.count() == 1, "count should be 1");
    }
}
```

ãƒ†ã‚¹ãƒˆãƒ©ãƒ³ãƒŠãƒ¼ã¯ï¼ŒCounterTest ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‚’ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ã¦ãƒ‡ãƒ—ãƒ­ã‚¤ã—ï¼ŒtestInc é–¢æ•°ã‚’ call ã—ã¾ã™ï¼
ã¾ãŸï¼Œhardhat ã¯ fuzz test ãªã©ã‚‚ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ï¼

```solidity
contract CounterTest {
    function testIncBy(uint by) public {
        Counter counter = new Counter();
        counter.incBy(by);
        require(counter.count() == by, "count should match the 'by' value");
    }
}

```

### ã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³ãƒ©ã‚¤ãƒ–ãƒ©ãƒª

ä¸Šã®ä¾‹ã®  fuzz test ã«ãŠã„ã¦å¤±æ•—ã—ãŸã¨ãï¼Œ`testIncBy(uint by)` ã® by ã¨ã„ã†å¼•æ•°ã®å€¤ã‚’çŸ¥ã‚‹ã“ã¨ã¯ solidity ã§ã¯ã§ãã¾ã›ã‚“ï¼ã‚‚ã£ã¨ã‚ˆã„ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å¾—ã‚‹ãŸã‚ã«ï¼Œforge-std ã¨ã„ã†ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’åˆ©ç”¨ã§ãã¾ã™ï¼

ã“ã‚Œã‚’åˆ©ç”¨ã™ã‚‹ãŸã‚ã«ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ã—ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™


```bash
npm install --save-dev github:foundry-rs/forge-std
```

ãã—ã¦ã“ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‹ã‚‰ï¼ŒTest ã¨ã„ã†ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¦ç¶™æ‰¿ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼

assertEq ã¨ã„ã†ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°ã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã§ï¼Œä¸ä¸€è‡´ã®ã¨ãã®å€¤ã‚’è¡¨ç¤ºã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼

```ts
import { Test } from "forge-std/Test.sol";

contract CounterTest is Test {
    function testIncBy(uint by) public {
        Counter counter = new Counter();
        counter.incBy(by);
        assertEq(counter.count(), by, "count should match the 'by' value");
    }
}
```


### SetUp é–¢æ•°

ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆã«ãŠã„ã¦å…±é€šã«åˆ©ç”¨ã™ã‚‹ãƒ­ã‚¸ãƒƒã‚¯ã‚’äº‹å‰ã«è¡Œã†é–¢æ•°ã§ã™

```solidity
contract CounterTest {
    Counter counter;

    function setUp() public {
      counter = new Counter();
    }

    function testInc() public {
        counter.inc();
        require(counter.count() == 1, "count should be 1");
    }

    function testIncBy(uint by) public {
        counter.incBy(by);
        require(counter.count() == by, "count should match the 'by' value");
    }
}
```


### Solidityãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œ

* å…¨ãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œ
  
```bash
npx hardhat test
```

* solidity ãƒ†ã‚¹ãƒˆã®ã¿ã®å®Ÿè¡Œ
  
```bash
npx hardhat test solidity
```

* æŒ‡å®šã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ç¾¤ã®ã¿ã®å®Ÿè¡Œ

```bash
npx hardhat test <test-file-1> <test-file-2> ...
```

## hardhat ã§ viem ã‚’åˆ©ç”¨ã™ã‚‹æ–¹æ³•

### ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

### ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¸ã®æ¥ç¶š

### viem ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®åˆ©ç”¨


### ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®ãƒ‡ãƒ—ãƒ­ã‚¤ã¨æ“ä½œ

### viem ãƒ™ãƒ¼ã‚¹å‡¦ç†ã®ãƒ†ã‚¹ãƒˆã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³



































========================================================================
# ä»¥ä¸‹ã¯ hatdhat 2 ã¾ã§ã®æ™‚ä»£ã®å¤ã„æƒ…å ±

### Chai.js ã«ã‚ˆã‚‹ãƒ†ã‚¹ãƒˆã®ã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³ã®è¨˜è¿°æ–¹æ³•

should , expect, assert ã®ï¼“ã‚¿ã‚¤ãƒ—ã®ãƒ†ã‚¹ãƒˆã®æµå„€ãŒåˆ©ç”¨å¯èƒ½

#### expect ã‚¿ã‚¤ãƒ—ã®å ´åˆ

* ãƒ¡ã‚½ãƒƒãƒ‰ãƒã‚§ãƒ¼ãƒ³(ä»¥ä¸‹ã®ãƒ¡ã‚½ãƒƒãƒ‰ã¯èª­ã¿ã‚„ã™ã•ã®ãŸã‚ã®ã‚‚ã®ã§ï¼Œå‡¦ç†ã®é€£é–ä»¥å¤–ã®æ„å‘³ã¯ç„¡ã„ï¼‰
to
be
does
have
and
...

* equal() : ç­‰ã—ã„
* a(å‹)/an(å‹) : å‹ãƒã‚§ãƒƒã‚¯
* include() ï¼šå«ã‚€
* not ï¼š ãã‚Œä»¥é™ã®å¦å®š
* true ï¼š trueã«ãªã‚‹
* false ï¼š falseã«ãªã‚‹
* within(é–‹å§‹, çµ‚äº†) : é–‹å§‹ã‹ã‚‰çµ‚äº†ã®é–“ 

```js
expect(x).to.equal(2);  		    // xã¯2ã«ç­‰ã—ã„
expect(x).to.be.a('string');  	// x ã¯stringå‹
expect(x).to.be.an('array');  	// x ã¯arrayå‹
expect(x).to.include(3);  		// xã¯3ã‚’å«ã‚€
expect(x).to.does.not.include(3);  // xã¯3ã‚’å«ã¾ãªã„
expect(x).to.be.true			  // xã¯ true
expect(x).to.be.false		    // xã¯ false
```

### Mocha ã«ã‚ˆã‚‹ãƒ†ã‚¹ãƒˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã®è¨˜è¿°

* ãƒ†ã‚¹ãƒˆã®å®šç¾©(describe)(
  * äº‹å‰æ¡ä»¶(before)
     * å€‹åˆ¥ã®ã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³ã®äº‹å‰æ¡ä»¶(beforeEach)
     * å€‹åˆ¥ã®ã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³(it) 
     * å€‹åˆ¥ã®ã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³ã®äº‹å‰æ¡ä»¶(afterEach)
  * çµæœ(after)
* )

#### Mochaã®æ–‡æ³•

* describe()	:ãƒ†ã‚¹ãƒˆã®å®šç¾©
* before()	ï¼šäº‹å‰æ¡ä»¶
* after()            : äº‹å¾Œæ¡ä»¶
* it()		ï¼šå€‹åˆ¥ã®ã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³
* beforeEach() ï¼šå€‹åˆ¥ã®ã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³ã®äº‹å‰å‡¦ç†
* afterEach()    ï¼šå€‹åˆ¥ã®ã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³ã®äº‹å¾Œå‡¦ç†


#### Mocha ã«ã‚ˆã‚‹ãƒ†ã‚¹ãƒˆã®ä¾‹

ä»¥ä¸‹ã¯ assert ã‚¹ã‚¿ã‚¤ãƒ«ã®ä¾‹ã§ã™

```js
describe("ã¹ãä¹—é–¢æ•° pow", function() {
  it("2ã®0ä¹—ã¯1", function() {
    assert(math.pow(2, 0)==1);
  });
  it("2ã®3ä¹—ã¯8", function() {
    assert(math.pow(2, 3)==(8));
  });
  it("2ã®-2ä¹—ã¯0.25", function() {
    assert(math.pow(2, -2)==0.25);
  });
});

```

expect ã‚¹ã‚¿ã‚¤ãƒ«ã®å ´åˆ

```js
describe("ã¹ãä¹—é–¢æ•° pow", function() {
  it("2ã®0ä¹—ã¯1", function() {
    expect(math.pow(2, 0)).to.equal(1);
  });
  it("2ã®3ä¹—ã¯8", function() {
    expect(math.pow(2, 3)).to.equal(8);
  });
  it("2ã®-2ä¹—ã¯0.25", function() {
    expect(math.pow(2, -2)).to.equal(0.25);
  });
});
```

### ethers.js (v6ç³») ã‚’ä½¿ã£ãŸã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®ãƒ‡ãƒ—ãƒ­ã‚¤

* ethers.deployContract é–¢æ•°

ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®ABIã‚„ãƒã‚¤ãƒˆã‚³ãƒ¼ãƒ‰ã¨åˆæœŸå€¤ã‚’å…¥ã‚Œã¦ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³åŒ–
ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã‚’ãƒ–ãƒ­ãƒ¼ãƒ‰ã‚­ãƒ£ã‚¹ãƒˆã—ã¦ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹

  * å¼•æ•°
    * ABI
    * ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆ
    * ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã®åˆæœŸå€¤ã®é…åˆ—: []
  * è¿”ã‚Šå€¤
    *ãƒ‡ãƒ—ãƒ­ã‚¤ã—ãŸãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã®ãƒãƒƒã‚·ãƒ¥å€¤
  
```js
const contract = await ethers.deployContract(abi, contract,[args])
```


### Hardhat Toolbox ã®åˆ©ç”¨

hardhat ã«ã¯ etheres.js ã‚’åˆ©ç”¨ã—ã¦é–‹ç™ºã™ã‚‹ãŸã‚ã®å„ç¨®ãƒ„ãƒ¼ãƒ«ãŒå‚™ã‚ã£ã¦ã„ã¾ã™ï¼

[Hardhat Toolbox](https://hardhat.org/hardhat-runner/plugins/nomicfoundation-hardhat-toolbox)


* test ã‚„ãƒ‡ãƒ—ãƒ­ã‚¤ã«ã¯ï¼Œhardhat toolbox ã‚’åˆ©ç”¨ã™ã‚‹ã®ãŒä¾¿åˆ©ã§ã™


## ãƒ†ã‚¹ãƒˆãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ä½œæˆ

* ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã®ä¸‹ã« test ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ãƒ†ã‚¹ãƒˆãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ä½œæˆã—ã¾ã™
* hardhat ã§ã¯ï¼Œchai ã‚’ ES6ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼ˆcommonJSãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼‰ã§ã¯ãªã Node.js ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¨ã—ã¦ require ã§èª­ã¿è¾¼ã‚€ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„

* Token.js 

```bash
nano test/Token.js
```

* hardhat toolbox ã® loadFixture ã‚’åˆ©ç”¨ã—ã¾ã™ï¼
* ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®ãƒ‡ãƒ—ãƒ­ã‚¤ã¨ãƒ†ã‚¹ãƒˆç”¨ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ç”Ÿæˆã™ã‚‹å‡¦ç†ã‚’é–¢æ•°ã¨ã—ã¦å®šç¾©ã—ã¦ã„ã¾ã™
* it ã«ã‚ˆã‚‹ãƒ†ã‚¹ãƒˆé …ç›®ã”ã¨ã«ä¸Šè¨˜ã®é–¢æ•°ã¨ loadFixture ã§ãƒ†ã‚¹ãƒˆç’°å¢ƒã‚’åˆæœŸåŒ–ã—ã¾ã™

```js
// hardhat tool box ã® loadFixture åˆ©ç”¨
const {loadFixture} = require("@nomicfoundation/hardhat-toolbox/network-helpers");
// Chaiã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’åˆ©ç”¨
const { expect } = require("chai");

// Token ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®ãƒ‡ãƒ—ãƒ­ã‚¤ã¨ãƒ†ã‚¹ãƒˆç”¨ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’æº–å‚™ã™ã‚‹é–¢æ•°
async function deployTokenFixture() {
  // ãƒ†ã‚¹ãƒˆç”¨ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®å–å¾—ï¼ˆethers.getSigners() ã¯ã‚¢ã‚«ã‚¦ãƒ³ãƒˆå–å¾—ç”¨é–¢æ•°ï¼‰
  const [owner, addr1, addr2] = await ethers.getSigners();
  // ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹
  const Token = await ethers.deployContract("Token");
  // ãƒ†ã‚¹ãƒˆç”¨ãƒ•ã‚£ã‚¯ã‚¹ãƒãƒ£
  return { Token, owner, addr1, addr2 };
}

describe("Tokenã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®ãƒ†ã‚¹ãƒˆ", function () {
  it("ãƒ‡ãƒ—ãƒ­ã‚¤ã«ã‚ˆã‚Šãƒˆãƒ¼ã‚¯ãƒ³ã®ç·é‡ãŒæ‰€æœ‰è€…ã«å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ã“ã¨", async function () {
    // Token ãƒ†ã‚¹ãƒˆç”¨ãƒ•ã‚£ã‚¯ã‚¹ãƒãƒ£ã‚’ãƒ­ãƒ¼ãƒ‰ã™ã‚‹
    const {Token, owner, addr1, addr2} = await loadFixture(deployTokenFixture);
    // ã‚ªãƒ¼ãƒŠãƒ¼ã®æ‰€æŒé‡‘ã®åˆæœŸå€¤
    const ownerBalance = await Token.balanceOf(owner.address);
    // ãƒˆãƒ¼ã‚¯ãƒ³ã®ç·é‡ãŒã‚ªãƒ¼ãƒŠãƒ¼ã®æ‰€æŒé‡‘ã®åˆæœŸå€¤ã¨ç­‰ã—ã„ã“ã¨ã®ç¢ºèª
    expect(await Token.totalSupply()).to.equal(ownerBalance);
  });
});
```

* ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ï¼š`<ctrl o>` ã§ä¿å­˜å…ˆãƒ•ã‚¡ã‚¤ãƒ«åã‚’ç¢ºèªã—ã¦ `<Enter>` ã§ä¿å­˜
* ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ï¼š`<ctrl x>` ã§ nano ã‚¨ãƒ‡ã‚£ã‚¿çµ‚äº†


### ãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œ

* ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã‹ã‚‰ hardhat ã®ãƒ†ã‚¹ãƒˆã‚¿ã‚¹ã‚¯ã‚’å®Ÿè¡Œã—ã¾ã™

```bash
npx hardhat test
=>

  Tokenã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®ãƒ†ã‚¹ãƒˆ
    âœ” ãƒ‡ãƒ—ãƒ­ã‚¤ã«ã‚ˆã‚Šãƒˆãƒ¼ã‚¯ãƒ³ã®ç·é‡ãŒæ‰€æœ‰è€…ã«å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ã“ã¨ (365ms)


  1 passing (367ms)
```

### ãƒ†ã‚¹ãƒˆãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®å†…å®¹ã®èª¬æ˜

* ethers ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯ï¼Œãƒ©ãƒƒãƒ”ãƒ³ã‚°ãƒ©ã‚¤ãƒ–ãƒ©ãƒª ethers.js ã‚’æ„å‘³ã—ã¾ã™ï¼
* ethers.getSigners() ã¯ï¼Œãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³é€ä¿¡è€…ï¼ˆç½²åè€…ï¼‰ã®Ethereumã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’è¿”ã™ãƒ¡ã‚½ãƒƒãƒ‰ã§ã™ï¼

```js
const [owner] = await ethers.getSigners();
```
* ethers.deployContract()  ã¯ï¼Œå¼•æ•°ã®ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ ethers.js ãƒ¡ã‚½ãƒƒãƒ‰ã§ã™ï¼
* ãƒ‡ãƒ—ãƒ­ã‚¤ãŒå®Œäº†ã™ã‚‹ã¨ Token ã¨ã„ã†ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒåˆ©ç”¨å¯èƒ½ã«ãªã‚Šã¾ã™ï¼

```js
const Token = await ethers.deployContract("Token");
```
* ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ Tokenã«å¯¾ã—ã¦ balanceOf ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ã†ã¨ Owner ã®æ‰€æŒé‡‘ã‚’ç¢ºèªã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼

```js
const ownerBalance = await Token.balanceOf(owner.address);
```
* ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ Token ã«å¯¾ã—ã¦ totalSupply ã¨ã„ã†ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ã£ã¦ãƒˆãƒ¼ã‚¯ãƒ³ã®ç·é‡ã‚’æ±‚ã‚ã¾ã™ï¼
* ã“ã“ã§ã¯ã•ã‚‰ã«ï¼Œãã®å€¤ãŒ Ownerã®æ‰€æŒé‡‘ã¨ç­‰ã—ã„ã“ã¨ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã™ï¼

```js
expect(await Token.totalSupply()).to.equal(ownerBalance);
```

#### ãƒ†ã‚¹ãƒˆã®ä¿®æ­£

```bash
nano test/Token.js
```

```js
// hardhat tool box ã®åˆ©ç”¨
const {loadFixture} = require("@nomicfoundation/hardhat-toolbox/network-helpers");
// CHaiã®åˆ©ç”¨
const { expect } = require("chai");

describe("Tokenã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆ", function () {
  async function deployTokenFixture() {
    // è¤‡æ•°ã®ãƒ†ã‚¹ãƒˆç”¨ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®å–å¾—
    const [owner, addr1, addr2] = await ethers.getSigners();
    // ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹
    const Token = await ethers.deployContract("Token");
    // Tokenãƒ†ã‚¹ãƒˆç”¨ãƒ•ã‚£ã‚¯ã‚¹ãƒãƒ£
    return { Token, owner, addr1, addr2 };
  }

  it("Tokenã®ç·é‡ãŒ owner ã«å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¦ã„ã‚‹ã“ã¨", async function () {
    // Tokenãƒ†ã‚¹ãƒˆç”¨ãƒ•ã‚£ã‚¯ã‚¹ãƒãƒ£ã‚’ãƒ­ãƒ¼ãƒ‰ã™ã‚‹
    const { Token, owner } = await loadFixture(deployTokenFixture);
    // ã‚ªãƒ¼ãƒŠãƒ¼ã®æ‰€æŒé‡‘é¡ã®ç¢ºèª
    const ownerBalance = await Token.balanceOf(owner.address);
    // ãƒˆãƒ¼ã‚¯ãƒ³ã®ç·é¡ã¯ã‚ªãƒ¼ãƒŠãƒ¼ã®æ‰€æŒé‡‘ã«ç­‰ã—ã„
    expect(await Token.totalSupply()).to.equal(ownerBalance);
  });

  it("ã‚¢ã‚«ã‚¦ãƒ³ãƒˆé–“ã§ãƒˆãƒ¼ã‚¯ãƒ³ãŒè»¢é€ã•ã‚Œã‚‹ã“ã¨", async function () {
    // Tokenãƒ†ã‚¹ãƒˆç”¨ãƒ•ã‚£ã‚¯ã‚¹ãƒãƒ£ã‚’ãƒ­ãƒ¼ãƒ‰ã™ã‚‹
    const { Token, owner, addr1, addr2 } = await loadFixture(
      deployTokenFixture
    );

    // 50ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ owner ã‹ã‚‰ addr1 ã«é€é‡‘ã™ã‚‹
    await expect(
      Token.transfer(addr1.address, 50)
    ).to.changeTokenBalances(Token, [owner, addr1], [-50, 50]);

    // 50ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ addr1 ã‹ã‚‰ addr2ã«é€é‡‘ã™ã‚‹
    // ã“ã“ã§ã¯ãƒˆãƒ¼ã‚¯ãƒ³ã®é€é‡‘ã« .connect(signer) ã‚’åˆ©ç”¨ã—ã¦ã„ã‚‹
    await expect(
      Token.connect(addr1).transfer(addr2.address, 50)
    ).to.changeTokenBalances(Token, [addr1, addr2], [-50, 50]);
  });
});

```

* ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ï¼š`<ctrl o>` ã§ä¿å­˜å…ˆãƒ•ã‚¡ã‚¤ãƒ«åã‚’ç¢ºèªã—ã¦ `<Enter>` ã§ä¿å­˜
* ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ï¼š`<ctrl x>` ã§ nano ã‚¨ãƒ‡ã‚£ã‚¿çµ‚äº†

#### ãƒ†ã‚¹ãƒˆã®å†å®Ÿè¡Œ

```bash
npx hardhat test 

=>
  Tokenã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆ
    âœ” Tokenã®ç·é‡ãŒ owner ã«å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¦ã„ã‚‹ã“ã¨ (316ms)
    âœ” ã‚¢ã‚«ã‚¦ãƒ³ãƒˆé–“ã§ãƒˆãƒ¼ã‚¯ãƒ³ãŒè»¢é€ã•ã‚Œã‚‹ã“ã¨


  2 passing (330ms)
```


## <a id="hhNetwork"> Hardhar Networkã®èµ·å‹•</a>

* ã“ã“ã‹ã‚‰æ–°ã—ãåˆ¥ã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚’é–‹ã
* ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã«ç§»å‹•ã™ã‚‹

```bash
cd ~/hardhat/tutorial
```

### hardhat node ã®èµ·å‹•

* è‡ªåˆ†ã®ãƒã‚·ãƒ³ã®ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã«ãƒ†ã‚¹ãƒˆç”¨ã® Ethereum Network Node ã‚’èµ·å‹•ã—ã¾ã™
* è‡ªå‹•çš„ã«20å€‹ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆï¼ˆEOA) ãŒç”Ÿæˆã•ã‚Œã¾ã™
* è‡ªå‹•ç”Ÿæˆã•ã‚ŒãŸã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¯ãã‚Œãã‚Œ 10000 Eth ã®è³‡é‡‘ã‚’æ‰€æœ‰ã—ã¦ã„ã¾ã™

```bash
npx hardhat node

=>
Started HTTP and WebSocket JSON-RPC server at http://127.0.0.1:8545/

Accounts
========

WARNING: These accounts, and their private keys, are publicly known.
Any funds sent to them on Mainnet or any other live network WILL BE LOST.

Account #0: 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266 (10000 ETH)
Private Key: 0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80

...

Account #19: 0x8626f6940E2eb28930eFb4CeF49B2d1F2C9C1199 (10000 ETH)
Private Key: 0xdf57089febbacf7ba0bc227dafbffa9fc08a93fdc68e1e42411a14efcf23656e

WARNING: These accounts, and their private keys, are publicly known.
Any funds sent to them on Mainnet or any other live network WILL BE LOST.

```

* å„ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã¨ç§˜å¯†éµã‚’ç¢ºèªã—ã¦ãã ã•ã„


### ãƒ¡ã‚¿ãƒã‚¹ã‚¯ã®åˆ©ç”¨

æœ‰åãªethrerum ãƒ¯ãƒ¬ãƒƒãƒˆã§ã™

![ãƒ¡ã‚¿ãƒã‚¹ã‚¯](images/metamask1.png)

å·¦ä¸Šã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶šãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’é¸æŠ

![ãƒ¡ã‚¿ãƒã‚¹ã‚¯](images/metamask2.png)

ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’è¿½åŠ ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯

ã€Œãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’æ‰‹å‹•ã§è¿½åŠ ã€ã‚’ã‚¯ãƒªãƒƒã‚¯

* ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯åï¼š hardhat network
* æ–°ã—ã„RPC URLï¼š http://localhost:8545/
* ãƒã‚§ãƒ¼ãƒ³IDï¼š 31337
* é€šè²¨è¨˜å·ï¼š ETH

ã§ã€Œä¿å­˜ã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«æ¥ç¶šã—ã¾ã™

### ãƒ¡ã‚¿ãƒã‚¹ã‚¯ã«ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’å–ã‚Šè¾¼ã‚€

* <img src="images/metamask3.png" width="300">

* <img src="images/metamask4.png" width="300">

* <img src="images/metamask5.png" width="300">

Hardhat node ã®èµ·å‹•ç”»é¢ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ãƒªã‚¹ãƒˆã«ã‚ã‚‹

* Private Key: ç§˜å¯†éµ

ã®ã©ã‚Œã‹ã‚’ç§˜å¯†éµã¨ã—ã¦ã‚³ãƒ”ãƒ¼ã—ã¦ãƒšãƒ¼ã‚¹ãƒˆã—ã¾ã™

* <img src="images/metamask6.png" width="400">



## ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®ãƒ‡ãƒ—ãƒ­ã‚¤

### hardhat ignition ã‚’åˆ©ç”¨ã—ãŸã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®ãƒ‡ãƒ—ãƒ­ã‚¤

* hardhat ignition ã¯ï¼Œãƒ‡ãƒ—ãƒ­ã‚¤ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’æŠ½è±¡åŒ–ã—ï¼Œãƒ‡ãƒ—ãƒ­ã‚¤ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¨ã—ã¦ï¼Œå®£è¨€çš„ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’è¨˜è¿°ã—ã¾ã™

#### Future ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ

* ã“ã®å®£è¨€çš„ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’å®Ÿæ–½ã™ã‚‹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ã“ã¨ã‚’ `Future` ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨å‘¼ã³ã¾ã™
* `Future` ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯ï¼Œãƒ‡ãƒ—ãƒ­ã‚¤ã‚’å®Ÿæ–½ã™ã‚‹æ–¹æ³•ã‚’è¨˜è¿°ã—ã¦ã„ã‚‹ã ã‘ã§ï¼Œå®Ÿéš›ã«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤ã¯è¡Œã„ã¾ã›ã‚“ï¼

#### buildModule é–¢æ•°

* buildModule é–¢æ•°ã¯ `Future` ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ç”Ÿæˆã™ã‚‹é–¢æ•°ã§ã™ï¼
* ã“ã®é–¢æ•°ã®ï¼Œç¬¬ï¼‘å¼•æ•°ãŒãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åã§ï¼Œç¬¬ï¼’å¼•æ•°ãŒãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’å®šç¾©ã™ã‚‹ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•°ã§ã™ï¼
* `Future` ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ç”Ÿæˆã¯ï¼Œ`contract` ãƒ¡ã‚½ãƒƒãƒ‰ã¨ `call` ãƒ¡ã‚½ãƒƒãƒ‰ã§å®Ÿæ–½ã—ã¾ã™ï¼
* `contract` ãƒ¡ã‚½ãƒƒãƒ‰ã¯ï¼Œã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ãŸã‚ã®æŒ‡ç¤ºã‚’ç”Ÿæˆã—ã¾ã™ï¼
* `call` ãƒ¡ã‚½ãƒƒãƒ‰ã¯ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®é–¢æ•°ã‚’å‘¼ã³å‡ºã™æŒ‡ç¤ºã‚’ç”Ÿæˆã—ã¾ã™ï¼

### ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«

```bash
nano ignition/modules/Token.js
```
  
```js
// hardhat toolbox ã‚’åˆ©ç”¨ã™ã‚‹
const { buildModule } = require("@nomicfoundation/hardhat-ignition/modules");

// ã“ã“ã§ã¯ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åã‚’ "Tutorial" ã«ã—ã¦ã„ã‚‹ï¼å¼•æ•° m ã«å®Ÿéš›ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒæ¸¡ã•ã‚Œã‚‹
module.exports = buildModule("Tutorial", (m) => {
  // ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆåTokenã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«å¯¾ã™ã‚‹ãƒ‡ãƒ—ãƒ­ã‚¤æŒ‡ç¤ºã¨ãªã‚‹ Future ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ç”Ÿæˆ
  // ã“ã®ä¾‹ã§ã¯ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã®å¼•æ•°ã¯ç„¡ã„ãŒï¼Œå¼•æ•°ãŒã‚ã‚‹å ´åˆã¯é…åˆ— [] ã®ä¸­ã«è¨­å®šã™ã‚‹
  const contract = m.contract("Token", []);
  // ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹Future ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’è¿”ã™
  return { contract };
});
```

### ãƒ‡ãƒ—ãƒ­ã‚¤ã®å®Ÿè¡Œ

* æ–°ã—ã„ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆãƒ»ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‹ã‚‰å®Ÿè¡Œ (--network ã®å¾Œã«ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’æŒ‡å®šã™ã‚‹)

```bash
npx hardhat ignition deploy ignition/modules/Token.js --network localhost

=>
Hardhat Ignition ğŸš€

Deploying [ Tutorial ]

Batch #1
  Executed Tutorial#Token

[ Tutorial ] successfully deployed ğŸš€

Deployed Addresses

Tutorial#Token - 0x5FbDB2315678afecb367f032d93F642f64180aa3

```

