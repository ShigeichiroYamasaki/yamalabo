# 01. Hardhat 3  ã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«

Ethereum ã®é–‹ç™ºç’°å¢ƒ

2025/12/05
Shigeichiro Yamasaki

hardhat 3 ã¯ï¼Œhardhat 2 ã¨å¤šãã®ç›¸é•ç‚¹ãŒã‚ã‚Šã¾ã™

* EVM ã¨å¯¾è©±ã™ã‚‹ãƒ©ãƒƒãƒ”ãƒ³ã‚°ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãŒï¼ŒEthers.js ã‹ã‚‰ viem ã«å¤‰æ›´ã•ã‚ŒãŸ
* ãƒ†ã‚¹ãƒˆè¨€èªã« solidityãŒè¿½åŠ ã•ã‚Œï¼ŒChai, moca ã‹ã‚‰ Node test runner ãŒãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã«ãªã£ãŸ
* TypeScript ã¨ ESM ãŒãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã«ãªã£ãŸ
* è¤‡æ•°ã®ãƒã‚§ãƒ¼ãƒ³ã¸ã®åŒæ™‚æ¥ç¶šãŒå¯èƒ½ã«ãªã£ãŸ


##  <a id="setup">ç’°å¢ƒã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—</a>

* hardhat node ã¯ãƒ­ãƒ¼ã‚«ãƒ«ãƒã‚·ãƒ³ã§å®Ÿè¡Œã™ã‚‹ã“ã¨ã‚’å‰æã«ã—ã¾ã™
* Node.js ã¨ JavaScript ã¨ TypeScript ã®çŸ¥è­˜ãŒå‰æã«ãªã‚Šã¾ã™

### ubuntu

```bash
sudo apt update
sudo apt upgrade -y
sudo apt install -y curl git tree
cd ~
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.40.3/install.sh | bash
\. "$HOME/.nvm/nvm.sh"
source ~/.profile

nvm install node
npm install -g yarn

node -v
=>
v25.2.1
```
* VS code ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
sudo snap install --classic code
```

### MacOSX

```bash
brew update
brew upgrade
brew install curl git tree
source $(brew --prefix nvm)/nvm.sh
echo 'source $(brew --prefix nvm)/nvm.sh' >> ~/.zprofile
source ~/.zprofile

cd ~
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.40.3/install.sh | bash
\. "$HOME/.nvm/nvm.sh"

nvm install node
npm install -g yarn

node -v
=>
v25.2.1
```

* VS code ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

[https://code.visualstudio.com/download](https://code.visualstudio.com/download) ã‹ã‚‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ©ãƒ¼ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰

## <a id="project">Hardhat ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®æ–°è¦ä½œæˆ</a>

### ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ•ã‚©ãƒ«ãƒ€ã®ä½œæˆ

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ•ã‚©ãƒ«ãƒ€ã‚’æ±ºã‚ã¾ã™ï¼

â˜… ã“ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ã€Œãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã€ã¨ã„ã„ã¾ã™ï¼

```bash
cd ~
mkdir hardhat
cd hardhat/
mkdir hardhat-example
cd hardhat-example
```

* ã“ã“ã§ã¯ï¼Œãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã‚’ hardhat-example ã¨ã„ã†åå‰ã®ãƒ•ã‚©ãƒ«ãƒ€ã«ã—ã¾ã™ãŒï¼Œé©å®œè‡ªåˆ†ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåã«ä¿®æ­£ã—ã¦ãã ã•ã„

### VS codeã‚’åˆ©ç”¨ã™ã‚‹å ´åˆ

æ‹¡å¼µæ©Ÿèƒ½ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

* Japanese Language Pack for Visual Studio Code
* Hardhat Developer Pack

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ VS code  ã‹ã‚‰æŒ‡å®š

### JavaScript ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ

init ã‚³ãƒãƒ³ãƒ‰ã§ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ•ã‚©ãƒ«ãƒ€ç¾¤ã‚’è‡ªå‹•ç”Ÿæˆã—ã¾ã™ï¼
ã¾ãŸï¼Œã“ã®ãƒ‘ã‚¹ãŒãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®èµ·ç‚¹ã¨ãªã‚‹ã€Œãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã€ã«ãªã‚Šã¾ã™ï¼
è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã¯ï¼Œpackage.json ã¨ã„ã†ãƒ•ã‚¡ã‚¤ãƒ«ã§ã™ï¼


### Hardhat 3 ã®åˆæœŸåŒ–

åˆæœŸåŒ–ã‚³ãƒãƒ³ãƒ‰

```bash
npx hardhat --init
```
å®Ÿè¡Œå¾Œ

```bash
Need to install the following packages:
hardhat@3.0.1
Ok to proceed? (y) 
```

* ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã® return ã‚­ãƒ¼ã‚’æŠ¼ã™ã¨ï¼Œä»¥ä¸‹ã®ã‚ˆã†ãªè¡¨ç¤ºãŒå‡ºç¾ã—ã¾ã™

```bash
=>
 â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                         â–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆ                  â–ˆâ–ˆâ–ˆ      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
â–‘â–‘â–ˆâ–ˆâ–ˆ  â–‘â–‘â–ˆâ–ˆâ–ˆ                         â–‘â–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆ                 â–‘â–ˆâ–ˆâ–ˆ     â–ˆâ–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆâ–ˆ
 â–‘â–ˆâ–ˆâ–ˆ   â–‘â–ˆâ–ˆâ–ˆ   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–‘â–‘â–‘  â–‘â–ˆ
 â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–‘â–‘â–‘â–‘â–‘â–ˆâ–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆâ–ˆ  â–‘â–‘â–‘â–‘â–‘â–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–ˆâ–ˆâ–ˆâ–‘      â–ˆâ–ˆâ–ˆâ–ˆâ–‘
 â–‘â–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–ˆâ–ˆâ–ˆ   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆ â–‘â–‘â–‘ â–‘â–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆ   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–‘â–ˆâ–ˆâ–ˆ      â–‘â–‘â–‘â–‘â–ˆâ–ˆâ–ˆ
 â–‘â–ˆâ–ˆâ–ˆ   â–‘â–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆ     â–‘â–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆâ–ˆ  â–‘â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆ
 â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–‘â–‘â–ˆâ–ˆ
â–‘â–‘â–‘â–‘â–‘  â–‘â–‘â–‘â–‘â–‘  â–‘â–‘â–‘â–‘â–‘â–‘â–‘ â–‘â–‘â–‘â–‘â–‘      â–‘â–‘â–‘â–‘â–‘â–‘â–‘ â–‘â–‘â–‘â–‘ â–‘â–‘â–‘â–‘â–‘  â–‘â–‘â–‘â–‘â–‘â–‘â–‘    â–‘â–‘â–‘â–‘â–‘   â–‘â–‘â–‘â–‘â–‘â–‘
 
ğŸ‘· Welcome to Hardhat v3.0.1 ğŸ‘·

? Which version of Hardhat would you like to use? â€¦ 
â¯ Hardhat 3 Beta (recommended for new projects)
  Hardhat 2 (older version)

```

* â¯ Hardhat 3 Beta (recommended for new projects) ã‚’é¸æŠã—ï¼Œreturn ã‚­ãƒ¼ã‚’æŠ¼ã™
* ãã®å¾Œã‚‚ï¼ŒãŸã  return ã‚­ãƒ¼ã‚’æŠ¼ã—ã¦ã„ãã¾ã™

### Hardhat 3 ã®ãƒ˜ãƒ«ãƒ—

ä»¥ä¸‹ã®ã‚ˆã†ã«ã—ã¦ help ã‚’ç¢ºèªã§ãã¾ã™

```bash
npx hardhat --help
=>
Hardhat version 3.0.17

Usage: hardhat [GLOBAL OPTIONS] <TASK> [SUBTASK] [TASK OPTIONS] [--] [TASK ARGUMENTS]

AVAILABLE TASKS:

...
```

### hardhat ã®Task 

ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ãªã© Hardhat ã®ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã‹ã‚‰å®Ÿè¡Œã™ã‚‹å‡¦ç†ã®ã“ã¨

å®Ÿè¡Œå½¢å¼  `npx hardhat <ã‚¿ã‚¹ã‚¯>` 


*  build    |         ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã¨artifactsã®æ§‹ç¯‰
*  clean    |         ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚„ artifacts ã®å…¨ãƒ‡ãƒ¼ã‚¿ã®æ¶ˆå»
*  compile  |         ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã¨artifactsã®æ§‹ç¯‰t (alias for build)
*  console  |         hardhat console ã‚’é–‹ã
*  flatten  |         ä¾å­˜é–¢ä¿‚ã®ã‚ã‚‹ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‚³ãƒ¼ãƒ‰ã‚’ã™ã¹ã¦ãƒ•ãƒ©ãƒƒãƒˆã«å‡ºåŠ›
*  node     |         Hardhat Networkã‚µãƒ¼ãƒãƒ¼ã¨JSON-RPCã®èµ·å‹•
*  run      |         ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ¦ãƒ¼ã‚¶å®šç¾©ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å®Ÿè¡Œ
*  telemetry|         è¨­å®šã®æ›´æ–°ã¨ç¢ºèª
*  test     |         ãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œ
*  verify             explorer ã‚’åˆ©ç”¨ã—ãŸã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®æ¤œè¨¼

### ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ

hardhat ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¯ä»¥ä¸‹ã®ã‚ˆã†ãªæ§‹æˆã«ãªã£ã¦ã„ã‚‹

```bash
tree -L 1
=>
.
â”œâ”€â”€ contracts
â”œâ”€â”€ hardhat.config.ts
â”œâ”€â”€ ignition
â”œâ”€â”€ node_modules
â”œâ”€â”€ package-lock.json
â”œâ”€â”€ package.json
â”œâ”€â”€ README.md
â”œâ”€â”€ scripts
â”œâ”€â”€ test
â””â”€â”€ tsconfig.json

6 directories, 5 files
```

ã•ã‚‰ã«ãã®ä¸‹ã®æ§‹é€ ã‚’ç¢ºèªã—ã¦ãã ã•ã„

```bash
tree contracts -L 1
=>
contracts
â”œâ”€â”€ Counter.sol
â””â”€â”€ Counter.t.sol

tree test -L 1    
=> 
test
â””â”€â”€ Counter.ts

tree ignition -L 1 
=>
ignition
â””â”€â”€ modules

tree scripts -L 1 
=>
scripts
â””â”€â”€ send-op-tx.ts
```


## <a id="compile">ã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®ä½œæˆã¨ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«</a>

* ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆãƒ»ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹

### Solidity ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ä½œæˆ ï¼ˆcontracts/Counter.solï¼‰

* contractãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ä¸‹ã« Solidityè¨€èªã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™ï¼
* ã“ã“ã§ã¯, ã‚µãƒ³ãƒ—ãƒ«ã¨ã—ã¦è‡ªå‹•ç”Ÿæˆã•ã‚Œã¦ã„ã‚‹ Counter.sol ã¨ã„ã†ãƒ•ã‚¡ã‚¤ãƒ«åã®ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‚’åˆ©ç”¨ã—ã¾ã™.
* Solidityãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã«ã¯ .sol ã¨ã„ã†æ‹¡å¼µå­ã‚’ã¤ã‘ã¾ã™ï¼

contracts/Counter.sol

```js
// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.8.28;

contract Counter {
  uint public x;

  event Increment(uint by);

  function inc() public {
    x++;
    emit Increment(1);
  }

  function incBy(uint by) public {
    require(by > 0, "incBy: increment should be positive");
    x += by;
    emit Increment(by);
  }
}

```


### ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«

ä»¥ä¸‹ã® hardhat ã® compile ã‚¿ã‚¹ã‚¯ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„

```bash
npx hardhat build
=>
Compiling your Solidity contracts...
Compiled 1 Solidity file with solc 0.8.28 (evm target: cancun)
```

### ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«çµæœã®ç¢ºèª

#### artifacts ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª

* ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«çµæœã®ABIã‚„ãƒã‚¤ãƒˆã‚³ãƒ¼ãƒ‰ãªã©ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯ artifacts ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«æ ¼ç´ã•ã‚Œã¾ã™

artifacts ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä»¥ä¸‹ã‚’3éšå±¤ã¾ã§æœ¨æ§‹é€ è¡¨ç¤ºã•ã›ã‚‹ã¨ä»¥ä¸‹ã®ã‚ˆã†ãªæ§‹é€ ãŒè¦‹ãˆã¾ã™

```bash
tree artifacts -L 3
=>
artifacts
â”œâ”€â”€ artifacts.d.ts
â”œâ”€â”€ build-info
â”‚Â Â  â”œâ”€â”€ solc-0_8_28-f51ae87ae795dce4b7c7ed5c8b1e794e7ad8d02a.json
â”‚Â Â  â””â”€â”€ solc-0_8_28-f51ae87ae795dce4b7c7ed5c8b1e794e7ad8d02a.output.json
â””â”€â”€ contracts
    â””â”€â”€ Counter.sol
        â”œâ”€â”€ artifacts.d.ts
        â””â”€â”€ Counter.json
```


#### ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«çµæœã®ãƒ•ã‚¡ã‚¤ãƒ«

artifacts/contracts ã®ä¸‹ã«ã‚ã‚‹ `'ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆå.sol` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ä¸‹ã® `ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆå.json` ã«JSONå½¢å¼ã«ãªã£ãŸã‚³ãƒ³ãƒ‘ã‚¤ãƒ«çµæœãŒã‚ã‚Šã¾ã™ï¼

```bash
cat artifacts/contracts/Counter.sol/Counter.json 
=>
{
  "_format": "hh3-artifact-1",
  "contractName": "Counter",
  "sourceName": "contracts/Counter.sol",
  "abi": [
    {
      "anonymous": false,
      "inputs": [
        {
          "indexed": false,
          "internalType": "uint256",
          "name": "by",
          "type": "uint256"
        }
      ],


...

```

## <a id="test"> ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®ãƒ†ã‚¹ãƒˆ</a>

hardhat 3 ã‹ã‚‰ï¼Œsolidity ã¨ TypeSctipt ã§ãƒ†ã‚¹ãƒˆè¨˜è¿°ã™ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸï¼


### Solidity ã«ã‚ˆã‚‹ãƒ†ã‚¹ãƒˆ

ãƒ†ã‚¹ãƒˆãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¯ï¼Œãƒ•ã‚¡ã‚¤ãƒ«åã®æ‹¡å¼µå­ãŒ `.t.sol` ã«ãªã‚Šã¾ã™

* contract/Counter.t.sol

```solidity
// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.8.28;

import {Counter} from "./Counter.sol";
import {Test} from "forge-std/Test.sol";

contract CounterTest is Test {
  Counter counter;

  function setUp() public {
    counter = new Counter();
  }

  function test_InitialValue() public view {
    require(counter.x() == 0, "Initial value should be 0");
  }

  function testFuzz_Inc(uint8 x) public {
    for (uint8 i = 0; i < x; i++) {
      counter.inc();
    }
    require(counter.x() == x, "Value after calling inc x times should be x");
  }

  function test_IncByZero() public {
    vm.expectRevert();
    counter.incBy(0);
  }
}

```

#### ã“ã®ãƒ†ã‚¹ãƒˆãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®æ¦‚è¦

* unit ãƒ†ã‚¹ãƒˆ
  * test_InitialValue é–¢æ•°ã¨ test_IncByZero é–¢æ•°
  * ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒç„¡ãï¼Œãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œã¯1å›ã ã‘
* fuzz ãƒ†ã‚¹ãƒˆ
  * testFuzz_Inc é–¢æ•°
  * ãƒ©ãƒ³ãƒ€ãƒ ãªå…¥åŠ›ã‚’å…¥ã‚Œã¦è¤‡æ•°å›ãƒ†ã‚¹ãƒˆãŒå®Ÿè¡Œã•ã‚Œã‚‹
  * ãƒ†ã‚¹ãƒˆãŒå¤±æ•—ã—ãŸã¨ãã¯ï¼Œãã®ã‚¤ãƒ³ãƒ—ãƒƒãƒˆãŒç¤ºã•ã‚Œã‚‹


#### ãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œ

ä»¥ä¸‹ã®ã‚ˆã†ã«ãƒ†ã‚¹ãƒˆã™ã‚‹ã¨ï¼Œã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆãŒå®Ÿè¡Œã•ã‚Œã¾ã™

```bash
npx hardhat test
=>
Compiling your Solidity contracts...

Nothing to compile

Running Solidity tests

  contracts/Counter.t.sol:CounterTest
    âœ” test_InitialValue()
    âœ” test_IncByZero()
    âœ” testFuzz_Inc(uint8) (runs: 256)


  3 passing

Running node:test tests

  Counter
    âœ” Should emit the Increment event when calling the inc() function
    âœ” The sum of the Increment events should match the current value


  2 passing (1435ms)

```

#### ãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œå†…å®¹

1. ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã¨ãƒ†ã‚¹ãƒˆã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«
2. test/ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ä¸‹ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒçµ±åˆã•ã‚Œã‚‹
3. ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‚„ãƒ†ã‚¹ãƒˆãŒãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚Œã‚‹
4. ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆãŒå®Ÿæ–½ã•ã‚Œï¼Œå¤±æ•—ã—ã¦ã„ã‚‹ãƒ†ã‚¹ãƒˆé …ç›®ã¯ failed ã¨è¨˜è¼‰ã•ã‚Œã‚‹


#### solidity ã®ãƒ†ã‚¹ãƒˆã®ã¿ã‚’è¡Œã†å ´åˆ

```bash
npx hardhat test solidity
Compiling your Solidity contracts...

Nothing to compile
Running Solidity tests

  contracts/Counter.t.sol:CounterTest
    âœ” test_InitialValue()
    âœ” test_IncByZero()
    âœ” testFuzz_Inc(uint8) (runs: 256)


  3 passingÃ¥
```



### TypeScript ãƒ†ã‚¹ãƒˆ

solidityã«ã‚ˆã‚‹ãƒ†ã‚¹ãƒˆã¯ï¼ŒEVM ã§ï¼Œå®Ÿéš›ã®å‹•ã‹ã™ã“ã¨ãŒã§ãã‚‹ã¨ã„ã†åˆ©ç‚¹ãŒã‚ã‚Šã¾ã™ï¼

ã—ã‹ã—ï¼Œsolidity è¨€èªã¯ãƒ†ã‚¹ãƒˆç”¨è¨€èªã¨ã—ã¦ã¯è¨˜è¿°åŠ›ãŒè²§å¼±ã§ã™ï¼
ä¾‹ãˆã°ï¼ŒéåŒæœŸå‡¦ç†ã®ãƒ†ã‚¹ãƒˆãªã©ã¯ã§ãã¾ã›ã‚“ï¼
TypeScript ã®ãƒ†ã‚¹ãƒˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’åˆ©ç”¨ã—ã¦è£œå¼·ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼

TypeScript ã®ãƒ†ã‚¹ãƒˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã§ã‚ã‚‹ [Node.js test runner](https://nodejs.org/api/test.html) ã‚’åˆ©ç”¨ã—ãŸãƒ†ã‚¹ãƒˆãŒã§ãã¾ã™

#### Node.js test runner ã®åŸºæœ¬

* åå‰ä»˜ããƒ†ã‚¹ãƒˆ

```ts
test("è¶³ã—ç®—", () => {
  assert.equal(1 + 2, 3);
});
```

* éåŒæœŸãƒ†ã‚¹ãƒˆ

```ts
test("éåŒæœŸ", async () => {
  const v = await Promise.resolve(42);
  assert.equal(v, 42);
});
```

* ã‚µãƒ–ãƒ†ã‚¹ãƒˆ

```ts
test("é…åˆ—æ“ä½œ (with hooks)", async (t) => {
  let arr: number[];

  await t.beforeEach(() => { arr = [1, 2, 3]; });
  await t.afterEach(() => { arr = []; });

  await t.test("push", () => {
    arr.push(4);
    assert.deepEqual(arr, [1, 2, 3, 4]);
  });

  await t.test("length", () => {
    assert.equal(arr.length, 3);
  });
});
```

### test/Counter.ts ã®ä¾‹

```ts
// We don't have Ethereum specific assertions in Hardhat 3 yet
import assert from "node:assert/strict";
import { describe, it } from "node:test";

import { network } from "hardhat";

describe("Counter", async function () {
  const { viem } = await network.connect();
  const publicClient = await viem.getPublicClient();

  it("Should emit the Increment event when calling the inc() function", async function () {
    const counter = await viem.deployContract("Counter");

    await viem.assertions.emitWithArgs(
      counter.write.inc(),
      counter,
      "Increment",
      [1n],
    );
  });

  it("The sum of the Increment events should match the current value", async function () {
    const counter = await viem.deployContract("Counter");
    const deploymentBlockNumber = await publicClient.getBlockNumber();

    // run a series of increments
    for (let i = 1n; i <= 10n; i++) {
      await counter.write.incBy([i]);
    }

    const events = await publicClient.getContractEvents({
      address: counter.address,
      abi: counter.abi,
      eventName: "Increment",
      fromBlock: deploymentBlockNumber,
      strict: true,
    });

    // check that the aggregated events match the current value
    let total = 0n;
    for (const event of events) {
      total += event.args.by;
    }

    assert.equal(total, await counter.read.x());
  });
});

```

#### TypeScriptãƒ†ã‚¹ãƒˆã®ã¿ã®å®Ÿè¡Œ

```bash
npx hardhat test nodejs
=>
Compiling your Solidity contracts...

Nothing to compile

Running node:test tests

  Counter
    âœ” Should emit the Increment event when calling the inc() function
    âœ” The sum of the Increment events should match the current value


  2 passing (1591ms)

```


### ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ãƒ¼ãƒ³ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¨å¯¾è©±ã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

`scripts` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«è¨˜è¿°ã™ã‚‹ TypeScript ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ãƒ¼ãƒ³ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¨å¯¾è©±ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™

* cripts/send-op-tx.ts ã®ä¾‹

```ts
import { network } from "hardhat";

const { viem } = await network.connect({
  network: "hardhatOp",
  chainType: "op",
});

console.log("Sending transaction using the OP chain type");

const publicClient = await viem.getPublicClient();
const [senderClient] = await viem.getWalletClients();

console.log("Sending 1 wei from", senderClient.account.address, "to itself");

const l1Gas = await publicClient.estimateL1Gas({
  account: senderClient.account.address,
  to: senderClient.account.address,
  value: 1n,
});

console.log("Estimated L1 gas:", l1Gas);

console.log("Sending L2 transaction");
const tx = await senderClient.sendTransaction({
  to: senderClient.account.address,
  value: 1n,
});

await publicClient.waitForTransactionReceipt({ hash: tx });

console.log("Transaction sent successfully");

```

* ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å®Ÿè¡Œ

```bash
npx hardhat run scripts/send-op-tx.ts
=>
Compiling your Solidity contracts...

Nothing to compile

Sending transaction using the OP chain type
Sending 1 wei from 0xf39fd6e51aad88f6f4ce6ab8827279cfffb92266 to itself
Estimated L1 gas: 1600n
Sending L2 transaction
Transaction sent successfully
```

## ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®ãƒ‡ãƒ—ãƒ­ã‚¤

hardhat ã«ã¯ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’å®£è¨€çš„ã«è¨˜è¿°ã§ãã‚‹ Hardhat Ignition ã¨ã„ã†ã‚·ã‚¹ãƒ†ãƒ ãŒã‚ã‚Šã¾ã™ï¼

ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®ãƒ‡ãƒ—ãƒ­ã‚¤ã®å®šç¾©ã¯ Ignition Module ã«ã‚ˆã£ã¦å®Ÿç¾ã•ã‚Œã¦ã„ã¾ã™ï¼

* Ignition module ã¯ï¼Œ`ignition/modules/` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«å®šç¾©ã—ã¾ã™
* ignition/modules/Counter.ts ã®ä¾‹

```ts
import { buildModule } from "@nomicfoundation/hardhat-ignition/modules";

export default buildModule("CounterModule", (m) => {
  const counter = m.contract("Counter");

  m.call(counter, "incBy", [5n]);

  return { counter };
});

```

ã“ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã® `m.call()` ã‚„ `m.contract()` ã¯ï¼Œãƒ‡ãƒ—ãƒ­ã‚¤ã‚’å®Ÿè¡Œã™ã‚‹é–¢æ•°ã§ã™ï¼

[ignition module å®šç¾©ã®è©³ã—ã„èª¬æ˜](https://hardhat.org/ignition/docs/guides/creating-modules)


* ãƒ‡ãƒ—ãƒ­ã‚¤ã®å®Ÿè¡Œ

```bash
npx hardhat ignition deploy ignition/modules/Counter.ts
=>
You are running Hardhat Ignition against an in-process instance of Hardhat Network.
This will execute the deployment, but the results will be lost.
You can use --network <network-name> to deploy to a different network.

Hardhat Ignition ğŸš€

Deploying [ CounterModule ]

Batch #1
  Executed CounterModule#Counter

Batch #2
  Executed CounterModule#Counter.incBy

[ CounterModule ] successfully deployed ğŸš€

Deployed Addresses

```

ã“ã®ä¾‹ã§ã¯ï¼Œã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã¯ Hardhat Network ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚Œã¦ã„ã¾ã™ãŒï¼Œãƒ¡ã‚¤ãƒ³ãƒãƒƒãƒˆã‚„ãƒ†ã‚¹ãƒˆãƒãƒƒãƒˆãªã©ä»–ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤ã‚‚å¯èƒ½ã§ã™ï¼


## Solidityã«ã‚ˆã‚‹ãƒ†ã‚¹ãƒˆã®è¨˜è¿°æ–¹æ³•

### Solidityãƒ†ã‚¹ãƒˆãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®è¨˜è¿°å ´æ‰€

* test/ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å ´åˆï¼š æ‹¡å¼µå­ .sol
* ontracts/ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å ´åˆï¼š æ‹¡å¼µå­ .t.sol

ä¾‹ãˆã° `contracts/CounterTest.t.sol` ã‚ã‚‹ã„ã¯ `test/CounterTest.sol` ã¨ã„ã†ãƒ†ã‚¹ãƒˆãƒ—ãƒ­ã‚°ãƒ©ãƒ ãŒå­˜åœ¨ã—ãŸå ´åˆ

```solidity
contract CounterTest {
    function testInc() public {
        Counter counter = new Counter();
        counter.inc();
        require(counter.count() == 1, "count should be 1");
    }
}
```

ãƒ†ã‚¹ãƒˆãƒ©ãƒ³ãƒŠãƒ¼ã¯ï¼ŒCounterTest ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‚’ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ã¦ãƒ‡ãƒ—ãƒ­ã‚¤ã—ï¼ŒtestInc é–¢æ•°ã‚’ call ã—ã¾ã™ï¼
ã¾ãŸï¼Œhardhat ã¯ fuzz test ãªã©ã‚‚ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ï¼

```solidity
contract CounterTest {
    function testIncBy(uint by) public {
        Counter counter = new Counter();
        counter.incBy(by);
        require(counter.count() == by, "count should match the 'by' value");
    }
}

```

### ã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³ãƒ©ã‚¤ãƒ–ãƒ©ãƒª

ä¸Šã®ä¾‹ã®  fuzz test ã«ãŠã„ã¦å¤±æ•—ã—ãŸã¨ãï¼Œ`testIncBy(uint by)` ã® by ã¨ã„ã†å¼•æ•°ã®å€¤ã‚’çŸ¥ã‚‹ã“ã¨ã¯ solidity ã§ã¯ã§ãã¾ã›ã‚“ï¼ã‚‚ã£ã¨ã‚ˆã„ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å¾—ã‚‹ãŸã‚ã«ï¼Œforge-std ã¨ã„ã†ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’åˆ©ç”¨ã§ãã¾ã™ï¼

ã“ã‚Œã‚’åˆ©ç”¨ã™ã‚‹ãŸã‚ã«ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ã—ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™


```bash
npm install --save-dev github:foundry-rs/forge-std
```

ãã—ã¦ã“ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‹ã‚‰ï¼ŒTest ã¨ã„ã†ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¦ç¶™æ‰¿ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼

assertEq ã¨ã„ã†ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°ã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã§ï¼Œä¸ä¸€è‡´ã®ã¨ãã®å€¤ã‚’è¡¨ç¤ºã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼

```ts
import { Test } from "forge-std/Test.sol";

contract CounterTest is Test {
    function testIncBy(uint by) public {
        Counter counter = new Counter();
        counter.incBy(by);
        assertEq(counter.count(), by, "count should match the 'by' value");
    }
}
```


### SetUp é–¢æ•°

ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆã«ãŠã„ã¦å…±é€šã«åˆ©ç”¨ã™ã‚‹ãƒ­ã‚¸ãƒƒã‚¯ã‚’äº‹å‰ã«è¡Œã†é–¢æ•°ã§ã™

```solidity
contract CounterTest {
    Counter counter;

    function setUp() public {
      counter = new Counter();
    }

    function testInc() public {
        counter.inc();
        require(counter.count() == 1, "count should be 1");
    }

    function testIncBy(uint by) public {
        counter.incBy(by);
        require(counter.count() == by, "count should match the 'by' value");
    }
}
```


### Solidityãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œ

* å…¨ãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œ
  
```bash
npx hardhat test
```

* solidity ãƒ†ã‚¹ãƒˆã®ã¿ã®å®Ÿè¡Œ
  
```bash
npx hardhat test solidity
```

* æŒ‡å®šã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ç¾¤ã®ã¿ã®å®Ÿè¡Œ

```bash
npx hardhat test <test-file-1> <test-file-2> ...
```

## hardhat ã§ viem ã‚’åˆ©ç”¨ã™ã‚‹æ–¹æ³•

### ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

* viem ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
npm install --save-dev @nomicfoundation/hardhat-viem
```

* hardhat.config.ts ã®ä¿®æ­£

```ts
...
import hardhatViem from "@nomicfoundation/hardhat-viem";

const config: HardhatUserConfig = {
  plugins: [
    hardhatViem,
    // ...other plugins...
  ],
  // ...other config...
};

export default config;
```


### ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¸ã®æ¥ç¶š

hardhat ã® network ãƒãƒãƒ¼ã‚¸ãƒ£ã® network connections ã‚’ä½¿ã£ã¦ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«æ¥ç¶šã—ã¾ã™

```ts
import { network } from "hardhat";

const connection = await network.connect();
```

viem ã‚’æ‹¡å¼µã—ãŸ hardhat-viem ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¯ã“ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶šæ©Ÿèƒ½ã®ãƒ˜ãƒ«ãƒ‘ãƒ¼ã‚’æä¾›ã—ã¾ã™

```ts
const { viem } = await network.connect();

const publicClient = await viem.getPublicClient();
console.log("Latest block number:", await publicClient.getBlockNumber());
```

### viem ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®åˆ©ç”¨æ–¹æ³•

hardhat-viem ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¯ viem ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’ç°¡å˜ã«åˆ©ç”¨ã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ï¼

* viem ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ç”Ÿæˆ
public client ã¯ï¼ŒgetPublicClient ãƒ¡ã‚½ãƒƒãƒ‰ã«ã‚ˆã£ã¦ç”Ÿæˆã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼

```ts
const { viem } = await network.connect();

const publicClient = await viem.getPublicClient();

console.log("Latest block number:", await publicClient.getBlockNumber());

```

* ãƒ¯ãƒ¬ãƒƒãƒˆã®ç”Ÿæˆ
getWalletClients ãƒ¡ã‚½ãƒƒãƒ‰ã«ã‚ˆã£ã¦ Hardhatã®è¨­å®šã«å¾“ã£ã¦ãƒ¯ãƒ¬ãƒƒãƒˆã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®é…åˆ—ã‚’è¿”ã—ã¾ã™

```ts
const [senderClient, receiverClient] = await viem.getWalletClients();

await senderClient.sendTransaction({
  to: receiverClient.account.address,
  value: 10n ** 18n,
});
```


### ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®ãƒ‡ãƒ—ãƒ­ã‚¤ã¨æ“ä½œ

hardhat-viem ã«ã¯ãƒ‡ãƒ—ãƒ­ã‚¤æ©Ÿèƒ½ã‚‚ã‚ã‚Šã¾ã™ï¼deployContract é–¢æ•°ã§ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’è¡Œã„ã¾ã™ï¼
ã“ã®é–¢æ•°ã®è¿”ã‚Šå€¤ã¯ viem contract instance ã§ã™

```ts
import { network } from "hardhat";

const { viem } = await network.connect();
const counter = await viem.deployContract("Counter");

await counter.write.inc();

console.log("Counter value:", await counter.read.x());
```

ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ãƒ¼ãŒå¼•æ•°ã‚’æŒã¤å ´åˆã¯ï¼Œç¬¬2å¼•æ•°ã§æ¸¡ã™ã“ã¨ãŒã§ãã¾ã™

```ts
const initialValue = 10n;
const counter = await viem.deployContract("Counter", [initialValue]);
```
ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ å®šç¾©ã•ã‚ŒãŸæœ€åˆã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‹ã‚‰ãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚Œã¾ã™ãŒï¼Œãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™

```ts
const [wallet1, wallet2] = await viem.getWalletClients();

const counter = await viem.deployContract("Counter", [10n], {
  client: {
    wallet: wallet2,
  },
});
```

deployContracté–¢æ•°ã¯ï¼Œãƒ‡ãƒ—ãƒ­ã‚¤ãŒå®Œäº†ã™ã‚‹ã¾ã§å¾…ã¡ã¾ã™ï¼
ãƒã‚¤ãƒ‹ãƒ³ã‚°ãŒå®Œäº†ã™ã‚‹ä»¥å‰ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã®ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã‚’é€ä¿¡ã—ãŸã„å ´åˆ sendDeploymentTransaction é–¢æ•°ã‚’ä½¿ã„ã¾ã™

```ts
const { deploymentTransaction } = await viem.sendDeploymentTransaction(
  "Counter",
  [10n],
  {
    client: {
      wallet: wallet2,
    },
  }
);

```


### viem ãƒ™ãƒ¼ã‚¹å‡¦ç†ã®ãƒ†ã‚¹ãƒˆã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³

hardhat-viem-assertions ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã«ã‚ˆã‚‹ TypeScriptãƒ†ã‚¹ãƒˆã®å®šç¾©æ–¹æ³•ã§ã™

* å‘¼ã³å‡ºã—ãŸé–¢æ•°ãŒæœŸå¾…ã—ãŸã‚¤ãƒ™ãƒ³ãƒˆã‚’ç™ºç”Ÿã—ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹ãƒ†ã‚¹ãƒˆ

```ts
it("Should emit the Increment event when calling the inc() function", async function () {
  const counter = await viem.deployContract("Counter");

  await viem.assertions.emitWithArgs(
    counter.write.inc(),
    counter,
    "Increment",
    [1n]
  );
});

```





## <a id="hhNetwork"> Hardhar Networkã®èµ·å‹•</a>

* ã“ã“ã‹ã‚‰æ–°ã—ãåˆ¥ã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚’é–‹ã
* ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã«ç§»å‹•ã™ã‚‹

### hardhat node ã®èµ·å‹•

* è‡ªåˆ†ã®ãƒã‚·ãƒ³ã®ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã«ãƒ†ã‚¹ãƒˆç”¨ã® Ethereum Network Node ã‚’èµ·å‹•ã—ã¾ã™
* è‡ªå‹•çš„ã«20å€‹ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆï¼ˆEOA) ãŒç”Ÿæˆã•ã‚Œã¾ã™
* è‡ªå‹•ç”Ÿæˆã•ã‚ŒãŸã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¯ãã‚Œãã‚Œ 10000 Eth ã®è³‡é‡‘ã‚’æ‰€æœ‰ã—ã¦ã„ã¾ã™

```bash
npx hardhat node

=>
Started HTTP and WebSocket JSON-RPC server at http://127.0.0.1:8545/

Accounts
========

WARNING: These accounts, and their private keys, are publicly known.
Any funds sent to them on Mainnet or any other live network WILL BE LOST.

Account #0: 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266 (10000 ETH)
Private Key: 0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80

...

Account #19: 0x8626f6940E2eb28930eFb4CeF49B2d1F2C9C1199 (10000 ETH)
Private Key: 0xdf57089febbacf7ba0bc227dafbffa9fc08a93fdc68e1e42411a14efcf23656e

WARNING: These accounts, and their private keys, are publicly known.
Any funds sent to them on Mainnet or any other live network WILL BE LOST.

```

* å„ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã¨ç§˜å¯†éµã‚’ç¢ºèªã—ã¦ãã ã•ã„


## ãƒ¡ã‚¿ãƒã‚¹ã‚¯ã®åˆ©ç”¨

æœ‰åãªethrerum ãƒ¯ãƒ¬ãƒƒãƒˆã§ã™

![ãƒ¡ã‚¿ãƒã‚¹ã‚¯](images/metamask1.png)

å·¦ä¸Šã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶šãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’é¸æŠ

![ãƒ¡ã‚¿ãƒã‚¹ã‚¯](images/metamask2.png)

ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’è¿½åŠ ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯

ã€Œãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’æ‰‹å‹•ã§è¿½åŠ ã€ã‚’ã‚¯ãƒªãƒƒã‚¯

* ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯åï¼š hardhat network
* æ–°ã—ã„RPC URLï¼š http://localhost:8545/
* ãƒã‚§ãƒ¼ãƒ³IDï¼š 31337
* é€šè²¨è¨˜å·ï¼š ETH

ã§ã€Œä¿å­˜ã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«æ¥ç¶šã—ã¾ã™

### ãƒ¡ã‚¿ãƒã‚¹ã‚¯ã«ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’å–ã‚Šè¾¼ã‚€

* <img src="images/metamask3.png" width="300">

* <img src="images/metamask4.png" width="300">

* <img src="images/metamask5.png" width="300">

Hardhat node ã®èµ·å‹•ç”»é¢ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ãƒªã‚¹ãƒˆã«ã‚ã‚‹

* Private Key: ç§˜å¯†éµ

ã®ã©ã‚Œã‹ã‚’ç§˜å¯†éµã¨ã—ã¦ã‚³ãƒ”ãƒ¼ã—ã¦ãƒšãƒ¼ã‚¹ãƒˆã—ã¾ã™

* <img src="images/metamask6.png" width="400">

* ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã« 10000 ETH ã®æ‰€æŒé‡‘ãŒã‚ã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹
* è¤‡æ•°ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’å–ã‚Šè¾¼ã¿ï¼ŒETH ã®é€é‡‘ãªã©ã‚’è©¦ã—ã¦ãã ã•ã„


