# SESAME Web API


事前にSESAMEアプリでSESAMEと WiFi module を登録しておく

パスワードの設定などを行う

## API KEYを取得

[https://partners.candyhouse.co/](https://partners.candyhouse.co/)

API_KEYの例

```
7jAuNxw6AR8vGmrO5JeoC4m6oi35UIsF81DvCxes
```

## ターミナル（MacOSX/ubuntu)からcurlコマンドでログインして認証キーを得る

* メールアドレス
* パスワード

```bash
curl -H "Content-Type: application/json" -X POST -d '{"email":"yamasaki@fuk.kindai.ac.jp", "password":"<パスワード>"}' https://api.candyhouse.co/v1/accounts/login
```


```json
{"authorization":"0973bc364710fe1e728ecd605e8b80cbd5b86bb613bf763df253f5cc46b2c394a9ba659fa4878f7d795b9b0ef7565cadfb081bffc77e7e2a671d150c9f1365cf12de8d7bd92923d02c22caeee286fff586caafc4952f802a5c88d63142e00084f60fc2148ea9ae8ba7ba4353bef20712dc0ebe6d71fb5bfc7efbe592f3c89613529df6232dbeed82cfc43ca550259b85619249a69b2a9ff3e802c7a4f4cf44db1fd67a09ad4034c7d421552656d9c651bc667167b1a37d9ea202f586ea39053ae031c7e07742a7bb078c436fcecd0cd47b3f42305eebef468fe229e1914c1ac3c2414085572898586869f3990d16b1db90f2b2b7dedf58b766e6eb1e0550907959a4427076f0046f23da049d22f33765169b0cc992ced815edb8b7317818b612264ce182739ffb45edf658bf5d2844d1e82a7fe68da660f3b6450af92af9c8fec8c47f76357e18e230195f21cb757f2f42bb1f150237908c1bc7d31531e95df04af3c3ce5f84ea257538103d13d4c503db0dc1cbc6b13c0c6a120077369096ca5703f523cdf75c90cef9a73926a067a5e1726749af4fd63c7b9870ace9dd2d863282133158c205c02b87e3af32bb2ab9631bdd716780dc8167abd8a60c4e8f6e"}
```

## 登録しているSESAMEの一覧を得る

* 自分のSESAMEの device_id を確認する

```bash
curl -H "X-Authorization:0973bc364710fe1e728ecd605e8b80cbd5b86bb613bf763df253f5cc46b2c394a9ba659fa4878f7d795b9b0ef7565cadfb081bffc77e7e2a671d150c9f1365cf12de8d7bd92923d02c22caeee286fff586caafc4952f802a5c88d63142e00084f60fc2148ea9ae8ba7ba4353bef20712dc0ebe6d71fb5bfc7efbe592f3c89613529df6232dbeed82cfc43ca550259b85619249a69b2a9ff3e802c7a4f4cf44db1fd67a09ad4034c7d421552656d9c651bc667167b1a37d9ea202f586ea39053ae031c7e07742a7bb078c436fcecd0cd47b3f42305eebef468fe229e1914c1ac3c2414085572898586869f3990d16b1db90f2b2b7dedf58b766e6eb1e0550907959a4427076f0046f23da049d22f33765169b0cc992ced815edb8b7317818b612264ce182739ffb45edf658bf5d2844d1e82a7fe68da660f3b6450af92af9c8fec8c47f76357e18e230195f21cb757f2f42bb1f150237908c1bc7d31531e95df04af3c3ce5f84ea257538103d13d4c503db0dc1cbc6b13c0c6a120077369096ca5703f523cdf75c90cef9a73926a067a5e1726749af4fd63c7b9870ace9dd2d863282133158c205c02b87e3af32bb2ab9631bdd716780dc8167abd8a60c4e8f6e" https://api.candyhouse.co/v1/sesames
```

```json
{"sesames": [{"device_id": "*******", "nickname": "kin", "is_unlocked": true, "api_enabled": true, "battery": 95}]}%   
```

## SESAMEをコントロール

* 自分のSESAMEの device_id を指定する
* lock :ロックする
* unlock : アンロックする

```bash
curl -H "X-Authorization: 0973bc364710fe1e728ecd605e8b80cbd5b86bb613bf763df253f5cc46b2c394a9ba659fa4878f7d795b9b0ef7565cadfb081bffc77e7e2a671d150c9f1365cf12de8d7bd92923d02c22caeee286fff586caafc4952f802a5c88d63142e00084f60fc2148ea9ae8ba7ba4353bef20712dc0ebe6d71fb5bfc7efbe592f3c89613529df6232dbeed82cfc43ca550259b85619249a69b2a9ff3e802c7a4f4cf44db1fd67a09ad4034c7d421552656d9c651bc667167b1a37d9ea202f586ea39053ae031c7e07742a7bb078c436fcecd0cd47b3f42305eebef468fe229e1914c1ac3c2414085572898586869f3990d16b1db90f2b2b7dedf58b766e6eb1e0550907959a4427076f0046f23da049d22f33765169b0cc992ced815edb8b7317818b612264ce182739ffb45edf658bf5d2844d1e82a7fe68da660f3b6450af92af9c8fec8c47f76357e18e230195f21cb757f2f42bb1f150237908c1bc7d31531e95df04af3c3ce5f84ea257538103d13d4c503db0dc1cbc6b13c0c6a120077369096ca5703f523cdf75c90cef9a73926a067a5e1726749af4fd63c7b9870ace9dd2d863282133158c205c02b87e3af32bb2ab9631bdd716780dc8167abd8a60c4e8f6e" -H "Content-Type: application/json" -X POST -d '{"type":"lock"}' https://api.candyhouse.co/v1/sesames/*******control
```


