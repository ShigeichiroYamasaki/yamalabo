# 0. Bitcoin core testnet4 ノードの構築

2025/10/26
作成，更新 Shigeichiro Yamasaki 



この演習ではシェルスクリプトを利用するので，簡単に解説しておきます．

### シェルスクリプトとは

Linux のコマンド操作を支援するためのプログラミング言語処理系です．

シャルスクリプトを使うと人間によるコマンド入力をプログラム化して自動実行できるようになります．

## シャルスクリプトの文法

### 変数への代入と評価

#### 代入演算子 '=' 

'=' 演算子を使って文字列や数値などを変数に代入することができます．

```bash
MyAddr="tb1qdu6n0yhtm7lpyyhev9vrw7mfg9sd80rxmv4mmh"
```

#### 評価演算子 '$'

評価演算子 '$' によって変数を評価して代入されている文字列を取り出す

```bash
$MyAddr

=>
tb1qdu6n0yhtm7lpyyhev9vrw7mfg9sd80rxmv4mmh: コマンドが見つかりません
```

'$' 演算子で出力された文字列はシェルによってさらにコマンドとして評価されます．

ここでは，アドレスの文字列がコマンドと解釈されるので「コマンドが見つかりません」というエラーになります．


date コマンドの場合
```bash
date

=>
2025年  6月 12日 水曜日 19:39:22 JST

D=date

$D
2025年 6月12日 水曜日 19時37分29秒 JST
```

#### ' " （シングルクォートとダブルクォート）

' " （シングルクォートとダブルクォート）は基本的に評価を停止し，囲まれた内容を文字列として扱うことを意味します．

シェルスクリプトでは，' （シングルクオート）や "（ダブルクォート）で囲まなくても文字列として扱われますが，文字列に空白が含まれる場合はクォーテーションで囲む必要があります．

```bash
Wallets='bitcoin-core.cli listwallets'

$Wallets

=>
[
  "alice"
]

```

* echo コマンド

python などのプログラミング言語での print文のように標準出力に文字列を出力するコマンドです．

```bash
echo $MyAddr

=>
tb1qdu6n0yhtm7lpyyhev9vrw7mfg9sd80rxmv4mmh
```

空白を含む文字列の場合は クォーテーションをつけます

```bash
echo 'bitcoin-core.cli listwallets'

=>
bitcoin-core.cli listwallets

echo "bitcoin-core.cli listwallets"

=>
bitcoin-core.cli listwallets
```

" （ダブルクォート）の文字列の中で変数を評価することができます．

```bash
echo "bitcoin-core.cli -rpcwallet=alice getaddressinfo $MyAddr"

=>
bitcoin-core.cli -rpcwallet=alice getaddressinfo tb1qdu6n0yhtm7lpyyhev9vrw7mfg9sd80rxmv4mmh
```

'（シングルクォート）の文字列の中では変数は評価されません

```bash
echo 'bitcoin-core.cli -rpcwallet=alice getaddressinfo $MyAddr'

=>
bitcoin-core.cli -rpcwallet=alice getaddressinfo $MyAddr
```

* 特殊文字とエスケープ

以下の文字は特殊文字なので，そのまま記述しても文字としては扱われません

```
* ? [ ' " ` \ $ ; & ( ) | ~ < > # % = スペース タブ 改行
```

特殊文字を文字として扱いたい場合は，その前に \（バックスラッシュ）をつけます

```bash
H="\"hello\""

=>
echo $H
"hello"
```

#### ` (バックスラッシュ) と $() によるコマンド置換

` (バックスラッシュ) は，クオートの反対で，囲まれた内容をシェルの処理系で評価することを意味します．

`$()` は ` (バックスラッシュ)の新しい表記方法で，基本的に同じことを意味しますが， \（バックスラッシュ）による特殊文字のエスケープの処理が少し異なっています．

コマンドの中にコマンドの実行結果を埋め込むことができます．

```bash
echo date
=>
date

echo `date`
=>
2024年 6月 13日 木曜日 00:55:18 JST

echo $(date)
=>
2024年 6月 13日 木曜日 00:55:28 JST
```

\（バックスラッシュ）による特殊文字のエスケープの処理の相違点

```bash
echo `echo '\\'`
=>
\

echo $(echo '\\')
=>
\\

```