# 0. Bitcoin core Signet ノードの構築

2023/05/04  更新 Shigeichiro Yamasaki

## install 方法

### MacOSXの場合

[Bitcoin core ダウンロードサイト](https://bitcoincore.org/bin/)からapple のdmg 形式のインストーラをダウンロードする


#### インストーラで bitcoin core をインストールしてアプリを起動

bitcon coreは「危険なアプリ」という扱いになっています。

* ドラックアンドドロップでアプリフォルダーにインストール
* アプリを起動してみる（起動しない）
* 「システム環境設定」の「セキュリティとプライバシー」で，ロックのアイコンをクリックしてパスワード入力
*  bitcoin coreに対して「ダウンロードしたアプリケーションの実行許可」を与える


#### アプリ起動

「アプリケーションフォルダ」の bitcoin core アプリ起動

--

### ubuntu 22.04LTS/の場合

#### snap でインストールする

```bash
sudo snap install bitcoin-core
```

#### bitcoin-qt アプリを起動してみる

リモート起動はできません

```
bitcoin-core.qt
```

ファイルメニューでアプリをプロセスを終了させる

#### bitcoind を起動してみる


```bash
bitcoin-core.daemon 
```

<control>-c でプロセスを終了させる

#### snap で bitcoin core をインストールしたときのコマンドインターフェース

* bitcoin-core.daemon : デーモン起動 (bitcoind)
* bitcoin-core.cli : クライアント (bitcoin-cli)

--

## bitcoind 設定ファイルを編集（作成）

設定ファイル (bitcoin.conf) を編集

bitcoin.confの場所

* ubuntu で通常インストールしたときの bitcoin.conf のデフォルトの場所
    * ~/.bitcoin/bitcoin.conf
* ubuntu でsnap でインストールした場bitcoin.conf のデフォルトの場所
    * ~/snap/bitcoin-core/common/.bitcoin/bitcoin.conf
* MacOSX でパッケージインストールしたときのbitcoin.conf のデフォルトの場所
    * ~/Library/Application Support/Bitcoin/bitcoin.conf


####  bitcoin.conf を編集

MacOSX 

```bash
nano ~/Library/Application Support/Bitcoin/bitcoin.conf
```

ubuntuでsnapでインストールした場合

```bash
nano ~/snap/bitcoin-core/common/.bitcoin/bitcoin.conf
```

##### bitcoin-qtの場合

* MacOSX :「ファイル」メニューの 「preferences」.. 
* ubuntu: 「設定」メニューの「オプション」
* 「設定ファイルを開く」ボタンをクリック
* 設定ファイルを以下のように作成して保存


```
signet=1
txindex=1
daemon=1
server=1
rest=1
[signet]
rpcuser=hoge
rpcpassword=hoge
rpcport=38332
port=38333
fallbackfee=0.00002
```

保存して終了

### bitcoind の起動

```bash
bitcoin-core.daemon &
```
同期が完了するまで時間がかかります

### 同期状態の確認

同期したブロック高

```bash
bitcoin-core.cli getblockcount

```

### bitcoin-core.cli でのワレット生成の注意

アカウントの秘密鍵が必要な場合、createwallet のデフォルトの設定では不可能な状態になってしまいます。

秘密鍵を取り出し可能なワレットの生成

### レガシーワレットの作成

```bash
bitcoin-core.cli -named createwallet wallet_name=alice descriptors=false
```

### アドレスの生成

```bash
bitcoin-core.cli -rpcwallet=alice getnewaddress 
```

## テスト用コインの入手

[https://signet.bc-2.jp/](https://signet.bc-2.jp/)


