# 2. bitcoin core の詳細

2025/10/24

更新 Shigeichiro Yamasaki

* [BIP](https://github.com/bitcoin/bips)


ubuntu で snap を使って bitcoin core をインストールした環境を前提にします

MacOS で HomeBrew で bitcoin core をインストールした場合や bitcoin-qt のコンソールからの場合は適宜コマンドなどを読み替えてください．


## 各種トランザクションの構成を一連の流れで演習します

以下のように，合計で4個のトランザクションを作成します．

```
(UTXOの資金)--> TX1 -+-->0.0002 BTC VOUT:1 -->TX2(P2WPKH) --> 0.00018 BTC
                    +-->0.0002 BTC VOUT:2 -->TX3(P2WSH)  --> 0.00018 BTC
                    +-->0.0002 BTC VOUT:5 -->TX4(P2TR)  --> 0.00018 BTC
                    +-->おつり
```


##  <a id="DESC"> </a>descriptor ワレットの作成

### UTXOの所有と discriptor

UTXO のアンロック方法を定義するために [BIP380](https://github.com/bitcoin/bips/blob/master/bip-0380.mediawiki) で output script descriptor という言語が提案されています．

### output script descriptorの構造

Scirpt Experession、Key Expression，チェックサムの３要素で構成されています．


#### Script Expression

 Bitcoinのスクリプトのタイプに対応し，関数として記述されます．
 引数として Key Expression をとります．

```
Script_Expression(Key_Expression)#checksum
```

|Script Expression|	定義 BIP|
|:--|:--|
pk(KEY)	|381
pkh(KEY)	|381
sh(SCRIPT)|	381
wpkh(KEY)	|382
wsh(SCRIPT)|	382
multi(NUM, KEY, ..., KEY)	|383
sortedmulti(NUM, KEY, ..., KEY)	|383
combo(KEY)	|384
raw(HEX)	|385
addr(ADDR)	|385
tr(KEY), tr(KEY, TREE)	|386
musig(KEY, KEY, ..., KEY)	|390


#### Key Expression

Script Expression をアンロックするために必要となる引数としての公開鍵や秘密鍵などの暗号鍵やその他の追加情報

#### チェックサム

`#` 記号のあとに８文字からなる bdch32 のエラー訂正符号に似たチェックサムを付加します

### descriptor の例

* 2-of-3 多重署名でロックされた P2WSHタイプの output を表現する Descriptor の例

```json
wsh(multi(2,037032106297741808e66c947dab836f3f3c28189596331e48861304674e2583d0,0210c7796ac91075ff6d4708319094707a976d265263cac42cc535104803439f84,0359ee82a3b3ec86bc8c29c149cacde7af2e00cd8952ee5767d6c221a2807c4094))#04tn9tty
```

### descriptor ワレットの作成

```
bitcoin-core.cli createwallet <ワレット名> <秘密鍵の無効化> <空ワレットの生成> <パスフレーズ> <再利用禁止> <*descripterの有効化> <起動時にロード> <外部署名の許可>
```

```bash
bitcoin-core.cli createwallet carol false false "" false true false

=>
{
  "name": "carol",
  "warnings": [
    "Empty string given as passphrase, wallet will not be encrypted."
  ]
}
```

他のワレットは unload しておく

```bash
bitcoin-core.cli listwallets

=>
[
  "carol"
]
```

ワレットの情報

```bash
bitcoin-core.cli getwalletinfo

=>
{
  "walletname": "carol",
  "walletversion": 169900,
  "format": "sqlite",
  "balance": 0.00000000,
  "unconfirmed_balance": 0.00000000,
  "immature_balance": 0.00000000,
  "txcount": 0,
  "keypoolsize": 4000,
  "keypoolsize_hd_internal": 4000,
  "paytxfee": 0.00000000,
  "private_keys_enabled": true,
  "avoid_reuse": false,
  "scanning": false,
  "descriptors": true,
  "external_signer": false,
  "blank": false,
  "birthtime": 1761315632,
  "lastprocessedblock": {
    "hash": "000000000c25741526f5cdfd5017f246b2dd24a4d434d3e119492c680ca99f64",
    "height": 107795
  }
}
```

### 最初のアドレス（最初のUTXOの所有者）の生成

```bash
Carol1=`bitcoin-core.cli getnewaddress`

```

### bob1 から Carol1に入金しておく

```bash
bitcoin-core.cli loadwallet bob
bitcoin-core.cli unloadwallet carol
bitcoin-core.cli sendtoaddress $Carol1 0.001
bitcoin-core.cli unloadwallet bob
bitcoin-core.cli loadwallet carol
```

```bash
bitcoin-core.cli getbalance
=>
0.00100000
```

## <a id="ADDR">3種類のビットコインアドレスの生成 </a>

3種類の outputのタイプへの送金には、それぞれ対応するアドレスタイプを持つ送金先アドレスが必要です。

以下に P2WPKH, P2WSH, P2TR の3タイプのアドレスを生成します．

#### getnewaddress コマンド

```bash
getnewaddress <ラベル> <アドレスタイプ>
```

アドレスタイプ

* legacy (base52アドレス）このタイプにさらに P2PKHとP2SHがあります
* bech32 (Bech32アドレス）このタイプにさらにP2WPKHとP2WSHがありあす
* p2sh-segwit (後方互換のため，Bech32アドレスをP2SHでラップしたアドレス)
* P2PK では、送金先の公開鍵がそのまま送金先アドレスになります

### P2PKアドレス

最も初期のアドレス形式です．

特別なアドレスフォーマットはなく，当事者の公開鍵がそのままアドレスになります

#### 公開鍵の確認方法

コマンドの文法

```
getaddressinfo <（自分のワレットの）ビットコインアドレス>
```


ここでは，P2WPKH として生成されたアドレスの情報から公開鍵を抜き出します．

```bash

以下は例です
```bash
bitcoin-core.cli getaddressinfo $Carol1

=>
{
  "address": "tb1q62k2fy9rr2jsvk3le6fx8l3egprddx9wj0vj7s",
  "scriptPubKey": "0014d2aca490a31aa5065a3fce9263fe394046d698ae",
  "ismine": true,
  "solvable": true,
  "desc": "wpkh([06fcddc5/84h/1h/0h/0/0]0368f7f9f45de1a91d60a597b6897ed6e9d0191ced3eb377ae06e6cec32616b130)#e8593kue",
  "parent_desc": "wpkh([06fcddc5/84h/1h/0h]tpubDCzXjgmT7qcmu8fx5x3Kh8VX76SZuYgVh8rWT9hbqd9KkWSKzhTWmg5d5aDmdSRnfSrfeMyYyKMfZHg4povMRZhGRR3NM9JxrnqLH8mJgFN/0/*)#072j0eza",
  "iswatchonly": false,
  "isscript": false,
  "iswitness": true,
  "witness_version": 0,
  "witness_program": "d2aca490a31aa5065a3fce9263fe394046d698ae",
  "pubkey": "0368f7f9f45de1a91d60a597b6897ed6e9d0191ced3eb377ae06e6cec32616b130",
  "ischange": false,
  "timestamp": 1761315632,
  "hdkeypath": "m/84h/1h/0h/0/0",
  "hdseedid": "0000000000000000000000000000000000000000",
  "hdmasterfingerprint": "06fcddc5",
  "labels": [
    ""
  ]
}

```

* 公開鍵は  JSON 構造のキー "pubkey": の部分です．



### P2WPKHアドレス 

Bech32アドレスの生成（受領者の公開鍵ハッシュの場合）

ここでは，シェル変数 P2WPKH_ADDR にアドレスを代入しておきます．

```bash
P2WPKH_ADDR=`bitcoin-core.cli getnewaddress wpkh_user bech32`

#確認例
echo $P2WPKH_ADDR

=>
tb1qwl7jjw7m6k95pfxxe8p6pkhr27s88p2zqtyh5y
```

### P2WSHアドレス

送金先は人間の当事者ではなく，bitcoin スクリプトにすることを意味します．
アドレスは公開鍵のハッシュ値ではなくスクリプトのハッシュ値から生成します．

スクリプトの典型例がマルチシグ（多重署名）用アドレスです。

#### マルチシグ用公開鍵のリストの作成
 
アドレスの生成には、n人の署名者たちの公開鍵が必要です。

* 3人の署名者のアドレス生成
  
```bash
SIGNER1=`bitcoin-core.cli getnewaddress`
SIGNER2=`bitcoin-core.cli getnewaddress`
SIGNER3=`bitcoin-core.cli getnewaddress`

```

* ３人の署名者の公開鍵

jq コマンドを利用することで JSON 形式の中の '.pubkey' という要素の値を取り出します
  
```bash
PUBKEY1=`bitcoin-core.cli getaddressinfo $SIGNER1|jq -r '.pubkey'`
PUBKEY2=`bitcoin-core.cli getaddressinfo $SIGNER2|jq -r '.pubkey'`
PUBKEY3=`bitcoin-core.cli getaddressinfo $SIGNER3|jq -r '.pubkey'`
```

#### ３つの公開鍵から 2 of 3 の場合の多重署名用アドレスを生成

```bash
P2WSH=`bitcoin-core.cli createmultisig 2 "[\"$PUBKEY1\",\"$PUBKEY2\",\"$PUBKEY3\"]" bech32`

# 確認例
echo $P2WSH
=>
{ "address": "tb1qlkt5ytc2wzwfsj56k76mdmh5d7wkm40emu8yaudg4seh7r8wn4mqfn3t98", "redeemScript": "522102a5a266b5a6d00621f06b7c7f35a31cbe354ede974f505254ddf146d7cd73330b210314cb66eaa66df6469a1020154d6f5cd75e438fadb8bf9a529a3cc5caeb96df8021025a40a94fcaa0e7fa56557a577115e74569e6f0af48a08fd12ff0577a860120a753ae", "descriptor": "wsh(multi(2,02a5a266b5a6d00621f06b7c7f35a31cbe354ede974f505254ddf146d7cd73330b,0314cb66eaa66df6469a1020154d6f5cd75e438fadb8bf9a529a3cc5caeb96df80,025a40a94fcaa0e7fa56557a577115e74569e6f0af48a08fd12ff0577a860120a7))#kcm4sywe" }

```

ここでは jq コマンドを利用してシェル変数 P2WSH_ADDR に内容を代入しておきます

```bash
P2WSH_ADDR=`echo $P2WSH|jq -r '.address'`


#### P2WSH の redeemScript

ここではシェル変数 P2WSH_REDEEMSCRIPT にその内容を代入しておきます

```bash
P2WSH_REDEEMSCRIPT=`echo $P2WSH|jq -r '.redeemScript'`

# 確認例
echo $P2WSH_REDEEMSCRIPT
=>
52210248213e8f4521d177938de16ebed519f1deb23560822c6a514495e68e2c75d9dc210353e0d6e0c1cea221fad989a82ad0cbb72ca538277b614e42bc975f891576cb3b210257638fdee103eced9aa5c24ade4d8c108c3069aee52b40d008a3ae6f389b942d53ae
```

#### P2WSH descriptor

ここでは，jq コマンドを使ってシェル変数 P2WSH_DESCRIPTOR にその内容を代入しておきます．

```bash
P2WSH_DESCRIPTOR=`echo $P2WSH|jq -r '.descriptor'`

#確認例
echo $P2WSH_DESCRIPTOR

=>
wsh(multi(2,02a5a266b5a6d00621f06b7c7f35a31cbe354ede974f505254ddf146d7cd73330b,0314cb66eaa66df6469a1020154d6f5cd75e438fadb8bf9a529a3cc5caeb96df80,025a40a94fcaa0e7fa56557a577115e74569e6f0af48a08fd12ff0577a860120a7))#kcm4sywe
```

### P2TRアドレス

P2TRのための Bech32m アドレスの生成（受領者の公開鍵）

ここでは，シェル変数 P2TR_ADDR にアドレスを代入しておきます．

getnewaddress コマンドでラベルの設定が必要です

```bash
P2TR_ADDR=`bitcoin-core.cli getnewaddress tr_user bech32m`

#確認例
echo $P2TR_ADDR
=>
tb1pu98a025a5pxa2mykur4kneq9jx0uwf56lxm3rnyt0wmda5tau4fs3e8qq5
```

## <a id="TX1"> </a>以上の UTXO を生成するトランザクションの送信


### 使用するUTXOを確認する

以下では、"amount": 0.0010000　を持つUTXOを利用しますが，実際には自分が所持している UTXO の金額でトランザクションを作成してください．

使用する"txid" と "vout"と "amount" と "address" の値をメモしてください

#### UTXOの例

自分のUTXOを確認してください

★★（以下は例です，必ず自分のUTXOのものをチェックしてください！）


UTXOを複数所持している場合は，amount が 0.001 以上あるものを一つ選んでください．


★★ （ここではUTXOの 金額を 0.001 BTC にしていますが，それよりも多い場合は必ずおつりの計算を間違えないようにしてください！！）

★★ （おつりの計算を間違えると，失った所持金はマイナーの報酬になり，戻ってきません）


```bash
bitcoin-core.cli listunspent

# ここでの例
=>
[
  {
    "txid": "cce6de349844462439d11c7ac866a5a5091e56a17d2a0380aeeb17c98720c363",
    "vout": 0,
    "address": "tb1q62k2fy9rr2jsvk3le6fx8l3egprddx9wj0vj7s",
    "label": "",
    "scriptPubKey": "0014d2aca490a31aa5065a3fce9263fe394046d698ae",
    "amount": 0.00100000,
    "confirmations": 61,
    "spendable": true,
    "solvable": true,
    "desc": "wpkh([06fcddc5/84h/1h/0h/0/0]0368f7f9f45de1a91d60a597b6897ed6e9d0191ced3eb377ae06e6cec32616b130)#e8593kue",
    "parent_descs": [
      "wpkh(tpubD6NzVbkrYhZ4X2aUb38G96kv46kJPEEULRRHEBvkVZNkiJpcXPdEunyUGkQQQ4iCK8GzoLmPKqFhFPs4SLkxMWNu5VDTNVCzwPwzg3FXAJE/84h/1h/0h/0/*)#mchyt24h"
    ],
    "safe": true
  }
]

```

この例では，UTXOの配列の1番目(インデックスは 0 から始まるので [0] になります)のUTXOの "amount" が  0.00100000 BTC なので，これを使うことにします．

シェル変数への代入を使う場合は以下のようになります


```bash
UTXOS=`bitcoin-core.cli listunspent`
UTXO=`echo $UTXOS | jq -r '.[0]'`

# 確認例
echo $UTXO

=>
{ "txid": "cce6de349844462439d11c7ac866a5a5091e56a17d2a0380aeeb17c98720c363", "vout": 0, "address": "tb1q62k2fy9rr2jsvk3le6fx8l3egprddx9wj0vj7s", "label": "", "scriptPubKey": "0014d2aca490a31aa5065a3fce9263fe394046d698ae", "amount": 0.00100000, "confirmations": 61, "spendable": true, "solvable": true, "desc": "wpkh([06fcddc5/84h/1h/0h/0/0]0368f7f9f45de1a91d60a597b6897ed6e9d0191ced3eb377ae06e6cec32616b130)#e8593kue", "parent_descs": [ "wpkh(tpubD6NzVbkrYhZ4X2aUb38G96kv46kJPEEULRRHEBvkVZNkiJpcXPdEunyUGkQQQ4iCK8GzoLmPKqFhFPs4SLkxMWNu5VDTNVCzwPwzg3FXAJE/84h/1h/0h/0/*)#mchyt24h" ], "safe": true }
```

自分のUTXOの txid , vout, address をシェル変数に代入します

```
TXID="<txidの内容>"
VOUT="<voutの内容>"
ADDRESS="<addressの内容>"
```


```bash
TXID=`echo $UTXO|jq -r '.txid'`
VOUT=`echo $UTXO|jq -r '.vout'`
CHANGE_ADDRESS=`echo $UTXO|jq -r '.address'`
```

★ この CHANGE_ADDRESS に指定するアドレスは，UTXOを所有している自分のアドレスで，おつりとして取り戻すためのアドレスです．

### 3+1 個のoutputを持つトランザクションを作成する

* input として使用するUTXOの txid と vout
* output は、生成した5つのアドレスです
* 5つの送金先アドレスへの送金金額は，それぞれ 0.0001 とします．
* outputにはおつり用のアドレスがさらに一つ必要です．ここではUTXOの所有者にします．

#### おつりの計算

ここではトランザクション手数料は 0.00002 以上とします．

UTXOの資金を 0.0039 BTC とすると

```
0.001 - (0.0001)*3 - 0.00002 = 0.0006799999999999999
```

なので，ここではおつりを 0.000679 BTC とします

### 3種類のアウトプットを持つ未署名トランザクションの作成

JSON形式で input と output を作成し，未署名のトランザクションを作成します

P2WPKH, P2WSH, P2TR の3種類です．

実行結果は 16進数形式です．

```bash
UNSIGNED_TX=`bitcoin-core.cli createrawtransaction "[{\"txid\":\"$TXID\",\"vout\":$VOUT}]" "[{\"$P2WPKH_ADDR\":0.0001},{\"$P2WSH_ADDR\":0.0001},{\"$P2TR_ADDR\":0.0001},{\"$CHANGE_ADDRESS\":0.000679}]"`

# 確認例
echo $UNSIGNED_TX

=>
020000000163c32087c917ebae80032a7da1561e09a5a566c87a1cd1392446449834dee6cc0000000000fdffffff04102700000000000016001477fd293bdbd58b40a4c6c9c3a0dae357a07385421027000000000000220020fd97422f0a709c984a9ab7b5b6eef46f9d6dd5f9df0e4ef1a8ac337f0cee9d761027000000000000225120576802db18bd40a557b6b680138f9df12c2a5a112b7f3f2dc118d3603f01c65e3c09010000000000160014d2aca490a31aa5065a3fce9263fe394046d698ae00000000
```

作成したトランザクションの確認

```bash
bitcoin-core.cli decoderawtransaction $UNSIGNED_TX

=>
{
  "txid": "fe0903f6bf4795c7f6828985861a8829332860389c64a5f035df5cc850f0f1ae",
  "hash": "fe0903f6bf4795c7f6828985861a8829332860389c64a5f035df5cc850f0f1ae",
  "version": 2,
  "size": 199,
  "vsize": 199,
  "weight": 796,
  "locktime": 0,
  "vin": [
    {
      "txid": "cce6de349844462439d11c7ac866a5a5091e56a17d2a0380aeeb17c98720c363",
      "vout": 0,
      "scriptSig": {
        "asm": "",
        "hex": ""
      },
      "sequence": 4294967293
    }
  ],
  "vout": [
    {
      "value": 0.00010000,
      "n": 0,
      "scriptPubKey": {
        "asm": "0 77fd293bdbd58b40a4c6c9c3a0dae357a0738542",
        "desc": "addr(tb1qwl7jjw7m6k95pfxxe8p6pkhr27s88p2zqtyh5y)#cajh006s",
        "hex": "001477fd293bdbd58b40a4c6c9c3a0dae357a0738542",
        "address": "tb1qwl7jjw7m6k95pfxxe8p6pkhr27s88p2zqtyh5y",
        "type": "witness_v0_keyhash"
      }
    },
    {
      "value": 0.00010000,
      "n": 1,
      "scriptPubKey": {
        "asm": "0 fd97422f0a709c984a9ab7b5b6eef46f9d6dd5f9df0e4ef1a8ac337f0cee9d76",
        "desc": "addr(tb1qlkt5ytc2wzwfsj56k76mdmh5d7wkm40emu8yaudg4seh7r8wn4mqfn3t98)#ur0npg5f",
        "hex": "0020fd97422f0a709c984a9ab7b5b6eef46f9d6dd5f9df0e4ef1a8ac337f0cee9d76",
        "address": "tb1qlkt5ytc2wzwfsj56k76mdmh5d7wkm40emu8yaudg4seh7r8wn4mqfn3t98",
        "type": "witness_v0_scripthash"
      }
    },
    {
      "value": 0.00010000,
      "n": 2,
      "scriptPubKey": {
        "asm": "1 576802db18bd40a557b6b680138f9df12c2a5a112b7f3f2dc118d3603f01c65e",
        "desc": "rawtr(576802db18bd40a557b6b680138f9df12c2a5a112b7f3f2dc118d3603f01c65e)#uz82mdr7",
        "hex": "5120576802db18bd40a557b6b680138f9df12c2a5a112b7f3f2dc118d3603f01c65e",
        "address": "tb1p2a5q9kcch4q224akk6qp8rua7ykz5ks39dln7twprrfkq0cpce0qtmmzxt",
        "type": "witness_v1_taproot"
      }
    },
    {
      "value": 0.00067900,
      "n": 3,
      "scriptPubKey": {
        "asm": "0 d2aca490a31aa5065a3fce9263fe394046d698ae",
        "desc": "addr(tb1q62k2fy9rr2jsvk3le6fx8l3egprddx9wj0vj7s)#cfc5n5av",
        "hex": "0014d2aca490a31aa5065a3fce9263fe394046d698ae",
        "address": "tb1q62k2fy9rr2jsvk3le6fx8l3egprddx9wj0vj7s",
        "type": "witness_v0_keyhash"
      }
    }
  ]
}
```

### 作成したトランザクションに署名する

```bash
SIGNED_TX=`bitcoin-core.cli signrawtransactionwithwallet $UNSIGNED_TX`

# 確認例
echo $SIGNED_TX

=>
{ "hex": "0200000000010163c32087c917ebae80032a7da1561e09a5a566c87a1cd1392446449834dee6cc0000000000fdffffff04102700000000000016001477fd293bdbd58b40a4c6c9c3a0dae357a07385421027000000000000220020fd97422f0a709c984a9ab7b5b6eef46f9d6dd5f9df0e4ef1a8ac337f0cee9d761027000000000000225120576802db18bd40a557b6b680138f9df12c2a5a112b7f3f2dc118d3603f01c65e3c09010000000000160014d2aca490a31aa5065a3fce9263fe394046d698ae024730440220359a74d350fc90d3fff7fddf2ff1e7c29f72453f550e9e879676ab4b28b418ff0220715499d49d5359ba9cd18cc32c43ad89ffecd7d7187c237205e9cf9c994b963601210368f7f9f45de1a91d60a597b6897ed6e9d0191ced3eb377ae06e6cec32616b13000000000", "complete": true }
```

署名したトランザクションの16進数形式内容の確認（hex の値）

```bash
SIGNED_TX_HEX=`echo $SIGNED_TX|jq -r '.hex'`

# 確認例
echo $SIGNED_TX_HEX

=>
0200000000010163c32087c917ebae80032a7da1561e09a5a566c87a1cd1392446449834dee6cc0000000000fdffffff04102700000000000016001477fd293bdbd58b40a4c6c9c3a0dae357a07385421027000000000000220020fd97422f0a709c984a9ab7b5b6eef46f9d6dd5f9df0e4ef1a8ac337f0cee9d761027000000000000225120576802db18bd40a557b6b680138f9df12c2a5a112b7f3f2dc118d3603f01c65e3c09010000000000160014d2aca490a31aa5065a3fce9263fe394046d698ae024730440220359a74d350fc90d3fff7fddf2ff1e7c29f72453f550e9e879676ab4b28b418ff0220715499d49d5359ba9cd18cc32c43ad89ffecd7d7187c237205e9cf9c994b963601210368f7f9f45de1a91d60a597b6897ed6e9d0191ced3eb377ae06e6cec32616b13000000000

```

★ txinwitness 領域が作成されていることを確認する

```bash
bitcoin-core.cli decoderawtransaction $SIGNED_TX_HEX

=>
{
  "txid": "fe0903f6bf4795c7f6828985861a8829332860389c64a5f035df5cc850f0f1ae",
  "hash": "65480821592b8b784dcfa6d196f87b347d77291afefcd31b80d54a5cf59f201e",
  "version": 2,
  "size": 308,
  "vsize": 227,
  "weight": 905,
  "locktime": 0,
  "vin": [
    {
      "txid": "cce6de349844462439d11c7ac866a5a5091e56a17d2a0380aeeb17c98720c363",
      "vout": 0,
      "scriptSig": {
        "asm": "",
        "hex": ""
      },
      "txinwitness": [
        "30440220359a74d350fc90d3fff7fddf2ff1e7c29f72453f550e9e879676ab4b28b418ff0220715499d49d5359ba9cd18cc32c43ad89ffecd7d7187c237205e9cf9c994b963601",
        "0368f7f9f45de1a91d60a597b6897ed6e9d0191ced3eb377ae06e6cec32616b130"
      ],
      "sequence": 4294967293
    }
  ],
  "vout": [
    {
      "value": 0.00010000,
      "n": 0,
      "scriptPubKey": {
        "asm": "0 77fd293bdbd58b40a4c6c9c3a0dae357a0738542",
        "desc": "addr(tb1qwl7jjw7m6k95pfxxe8p6pkhr27s88p2zqtyh5y)#cajh006s",
        "hex": "001477fd293bdbd58b40a4c6c9c3a0dae357a0738542",
        "address": "tb1qwl7jjw7m6k95pfxxe8p6pkhr27s88p2zqtyh5y",
        "type": "witness_v0_keyhash"
      }
    },
    {
      "value": 0.00010000,
      "n": 1,
      "scriptPubKey": {
        "asm": "0 fd97422f0a709c984a9ab7b5b6eef46f9d6dd5f9df0e4ef1a8ac337f0cee9d76",
        "desc": "addr(tb1qlkt5ytc2wzwfsj56k76mdmh5d7wkm40emu8yaudg4seh7r8wn4mqfn3t98)#ur0npg5f",
        "hex": "0020fd97422f0a709c984a9ab7b5b6eef46f9d6dd5f9df0e4ef1a8ac337f0cee9d76",
        "address": "tb1qlkt5ytc2wzwfsj56k76mdmh5d7wkm40emu8yaudg4seh7r8wn4mqfn3t98",
        "type": "witness_v0_scripthash"
      }
    },
    {
      "value": 0.00010000,
      "n": 2,
      "scriptPubKey": {
        "asm": "1 576802db18bd40a557b6b680138f9df12c2a5a112b7f3f2dc118d3603f01c65e",
        "desc": "rawtr(576802db18bd40a557b6b680138f9df12c2a5a112b7f3f2dc118d3603f01c65e)#uz82mdr7",
        "hex": "5120576802db18bd40a557b6b680138f9df12c2a5a112b7f3f2dc118d3603f01c65e",
        "address": "tb1p2a5q9kcch4q224akk6qp8rua7ykz5ks39dln7twprrfkq0cpce0qtmmzxt",
        "type": "witness_v1_taproot"
      }
    },
    {
      "value": 0.00067900,
      "n": 3,
      "scriptPubKey": {
        "asm": "0 d2aca490a31aa5065a3fce9263fe394046d698ae",
        "desc": "addr(tb1q62k2fy9rr2jsvk3le6fx8l3egprddx9wj0vj7s)#cfc5n5av",
        "hex": "0014d2aca490a31aa5065a3fce9263fe394046d698ae",
        "address": "tb1q62k2fy9rr2jsvk3le6fx8l3egprddx9wj0vj7s",
        "type": "witness_v0_keyhash"
      }
    }
  ]
}
```

### 署名したトランザクションをブロードキャストする

返り値のトランザクションIDをメモする

```bash
SENT_TXID=`bitcoin-core.cli sendrawtransaction $SIGNED_TX_HEX`

#確認例
echo $SENT_TXID

=>
fe0903f6bf4795c7f6828985861a8829332860389c64a5f035df5cc850f0f1ae
```

### 送信したトランザクションを確認する

引数のトランザクションIDは，自分が送信したトランザクションIDです

```bash
bitcoin-core.cli gettransaction $SENT_TXID
```

### 10分以上経過後，UTXOのリストを確認する

UTXOの数が増えていることを確認します．

```bash
bitcoin-core.cli listunspent

```

## <a id="PREP"> </a>次の演習への準備

シェル変数に格納していた内容を次回の演習のために保存しておきます．

各自それぞれの環境によって内容が異なります．

確実に自分のシェル変数の内容を保管しておき，次回に再現できるようにしておきましょう．

